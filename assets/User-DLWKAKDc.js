import{_ as C,b as n,d as t,j as h,u as g,q as w,t as N,l as x,B as L,C as k,r,x as U,o as _,a0 as B,G as D,$ as P,i}from"./index-8FNVx0O0.js";const R={name:"ProfilePage",setup(){const u=r(!1),e=U(),v=D(),o=r(e.user),m=r(null),d=r(!1),s=r(""),a=r(null),y=()=>{u.value=!0},c=async(l=!1)=>{u.value=!1,e.logout(),l?await v.push("/"):await v.push("/login"),v.go(0)},b=()=>{s.value=o.value.name,d.value=!0,P(()=>{var l,f;(l=a.value)==null||l.focus(),(f=a.value)==null||f.select()})},p=async()=>{if(s.value.trim()&&s.value.trim()!==o.value.name)try{await e.updateUserName(s.value.trim()),o.value.name=s.value.trim()}catch(l){console.error("Ошибка при обновлении имени:",l)}d.value=!1},E=()=>{d.value=!1,s.value=""};return _(async()=>{if(o.value||c(!0),o.value.photo){const l=await B();m.value="".concat(l).concat(o.value.photo)}}),{user:o,showDialog:u,confirmLogout:y,logout:c,photoURL:m,isEditingName:d,editingName:s,nameInput:a,startEditName:b,saveName:p,cancelEditName:E}}},S={class:"profile-container"},V={key:0,class:"profile-content"},I={class:"profile-photo"},T={key:0,alt:"Profile Photo"},z={key:1,class:"photo-placeholder"},A={class:"profile-info"},K={class:"info-item"},M={class:"editable-field"},j={key:1,class:"edit-input-container"},q={key:1,class:"loading"},G={key:2,class:"dialog-overlay"},F={class:"dialog modern-dark-dialog"},H={class:"dialog-footer"};function J(u,e,v,o,m,d){const s=w("lazy");return i(),n("div",S,[e[14]||(e[14]=t("div",{class:"profile-header"},[t("h1",null,"Профиль")],-1)),o.user?(i(),n("div",V,[t("div",I,[o.user.photo&&o.photoURL?g((i(),n("img",T,null,512)),[[s,o.photoURL]]):(i(),n("div",z,N(String.fromCodePoint(o.user.name.codePointAt(0)).toLocaleUpperCase()),1))]),t("div",A,[t("div",K,[e[11]||(e[11]=t("label",null,"Имя:",-1)),t("div",M,[o.isEditingName?(i(),n("div",j,[g(t("input",{ref:"nameInput","onUpdate:modelValue":e[1]||(e[1]=a=>o.editingName=a),class:"edit-input",maxlength:"50",onKeyup:[e[2]||(e[2]=k((...a)=>o.saveName&&o.saveName(...a),["enter"])),e[3]||(e[3]=k((...a)=>o.cancelEditName&&o.cancelEditName(...a),["esc"]))],onBlur:e[4]||(e[4]=(...a)=>o.saveName&&o.saveName(...a))},null,544),[[L,o.editingName]]),t("button",{class:"save-btn",onClick:e[5]||(e[5]=(...a)=>o.saveName&&o.saveName(...a))},"✓"),t("button",{class:"cancel-btn",onClick:e[6]||(e[6]=(...a)=>o.cancelEditName&&o.cancelEditName(...a))},"✕")])):(i(),n("span",{key:0,class:"editable-text",onClick:e[0]||(e[0]=(...a)=>o.startEditName&&o.startEditName(...a))},[x(N(o.user.name)+" ",1),e[10]||(e[10]=t("i",{class:"fas fa-edit edit-icon"},null,-1))]))])])]),t("button",{class:"logout-btn",onClick:e[7]||(e[7]=(...a)=>o.confirmLogout&&o.confirmLogout(...a))},"Выйти")])):(i(),n("div",q,"Загрузка профиля...")),o.showDialog?(i(),n("div",G,[t("div",F,[e[12]||(e[12]=t("div",{class:"dialog-header"},[t("h3",null,"Выход")],-1)),e[13]||(e[13]=t("div",{class:"dialog-body"},[t("p",null,"Вы уверены?")],-1)),t("div",H,[t("button",{class:"modern-dark-btn",onClick:e[8]||(e[8]=a=>o.showDialog=!1)},"Отмена"),t("button",{class:"modern-dark-btn danger",onClick:e[9]||(e[9]=(...a)=>o.logout&&o.logout(...a))},"Выйти")])])])):h("",!0)])}const Q=C(R,[["render",J],["__scopeId","data-v-27307cba"]]);export{Q as default};
