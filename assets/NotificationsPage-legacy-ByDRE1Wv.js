!function(){function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var a,n,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",r=o.toStringTag||"@@toStringTag";function c(t,o,i,r){var c=o&&o.prototype instanceof l?o:l,s=Object.create(c.prototype);return e(s,"_invoke",function(t,e,o){var i,r,c,l=0,s=o||[],f=!1,p={p:0,n:0,v:a,a:v,f:v.bind(a,4),d:function(t,e){return i=t,r=0,c=a,p.n=e,d}};function v(t,e){for(r=t,c=e,n=0;!f&&l&&!o&&n<s.length;n++){var o,i=s[n],v=p.p,u=i[2];t>3?(o=u===e)&&(c=i[(r=i[4])?5:(r=3,3)],i[4]=i[5]=a):i[0]<=v&&((o=t<2&&v<i[1])?(r=0,p.v=e,p.n=i[1]):v<u&&(o=t<3||i[0]>e||e>u)&&(i[4]=t,i[5]=e,p.n=u,r=0))}if(o||t>1)return d;throw f=!0,e}return function(o,s,u){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&v(s,u),r=s,c=u;(n=r<2?a:c)||!f;){i||(r?r<3?(r>1&&(p.n=-1),v(r,c)):p.n=c:p.v=c);try{if(l=2,i){if(r||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,r<2&&(r=0)}else 1===r&&(n=i.return)&&n.call(i),r<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),r=1);i=a}else if((n=(f=p.n<0)?c:t.call(e,p))!==d)break}catch(n){i=a,r=1,c=n}finally{l=1}}return{value:n,done:f}}}(t,i,r),!0),s}var d={};function l(){}function s(){}function f(){}n=Object.getPrototypeOf;var p=[][i]?n(n([][i]())):(e(n={},i,function(){return this}),n),v=f.prototype=l.prototype=Object.create(p);function u(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,r,"GeneratorFunction")),t.prototype=Object.create(v),t}return s.prototype=f,e(v,"constructor",f),e(f,"constructor",s),s.displayName="GeneratorFunction",e(f,r,"GeneratorFunction"),e(v),e(v,r,"Generator"),e(v,i,function(){return this}),e(v,"toString",function(){return"[object Generator]"}),(t=function(){return{w:c,m:u}})()}function e(t,a,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}e=function(t,a,n,o){function r(a,n){e(t,a,function(t){return this._invoke(a,n,t)})}a?i?i(t,a,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[a]=n:(r("next",0),r("throw",1),r("return",2))},e(t,a,n,o)}function a(t,e,a,n,o,i,r){try{var c=t[i](r),d=c.value}catch(t){return void a(t)}c.done?e(d):Promise.resolve(d).then(n,o)}function n(t){return function(){var e=this,n=arguments;return new Promise(function(o,i){var r=t.apply(e,n);function c(t){a(r,o,i,c,d,"next",t)}function d(t){a(r,o,i,c,d,"throw",t)}c(void 0)})}}System.register(["./index-legacy-DCa58GTX.js","./useCommentFormatting-legacy-1hRIO6P1.js","./SpinnerLoading-legacy-CBnVAV-L.js"],function(e,a){"use strict";var o,i,r,c,d,l,s,f,p,v,u,m,g,x,b,h,y,k,w,_,j,z,O,T,C,E;return{setters:[t=>{o=t._,i=t.p,r=t.b,c=t.i,d=t.d,l=t.j,s=t.e,f=t.w,p=t.l,v=t.t,u=t.D,m=t.a2,g=t.n,x=t.aN,b=t.x,h=t.r,y=t.c,k=t.o,w=t.G,_=t.a,j=t.m,z=t.E,O=t.F,T=t.f},t=>{C=t.u},t=>{E=t.S}],execute:function(){var a=document.createElement("style");a.textContent=".notification-item[data-v-2e25d2c6]{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border-radius:8px;padding:10px;position:relative;transition:all .3s ease;border:1px solid rgba(255,255,255,.1)}.notification-item[data-v-2e25d2c6]:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.1)}.notification-item.unread[data-v-2e25d2c6]{background:rgba(255,255,255,.1);border-color:var(--accent-color)}.notification-content[data-v-2e25d2c6]{display:flex;gap:8px;align-items:flex-start}.notification-avatar[data-v-2e25d2c6]{flex-shrink:0;width:40px;height:40px;border-radius:50%;overflow:hidden;background:var(--accent-color);display:flex;align-items:center;justify-content:center}.avatar-img[data-v-2e25d2c6]{width:100%;height:100%;object-fit:cover}.avatar-icon[data-v-2e25d2c6]{color:#fff;font-size:18px}.notification-main[data-v-2e25d2c6]{flex:1;min-width:0}.notification-header[data-v-2e25d2c6]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:4px;gap:8px}.notification-info[data-v-2e25d2c6]{display:flex;flex-wrap:wrap;gap:4px;align-items:center}.sender-name[data-v-2e25d2c6]{font-weight:600;color:var(--text-color)}.notification-type[data-v-2e25d2c6]{color:var(--text-color)}.movie-title[data-v-2e25d2c6]{color:var(--text-color);font-weight:500;text-decoration:underline;display:inline}.movie-title[data-v-2e25d2c6]:hover{color:var(--text-color)}.notification-time[data-v-2e25d2c6]{color:var(--muted-color);font-size:.85rem;white-space:nowrap}.notification-message[data-v-2e25d2c6]{color:var(--text-color);margin-bottom:6px;font-weight:500;font-size:.95rem}.comment-preview[data-v-2e25d2c6]{background:rgba(255,255,255,.05);border-radius:6px;padding:8px;margin-bottom:6px;border-left:2px solid var(--accent-color)}.original-comment[data-v-2e25d2c6],.reply-comment[data-v-2e25d2c6]{display:flex;align-items:flex-start;gap:8px;margin-bottom:6px}.original-comment[data-v-2e25d2c6]:last-child,.reply-comment[data-v-2e25d2c6]:last-child{margin-bottom:0}.comment-preview i[data-v-2e25d2c6]{color:var(--muted-color);font-size:.8rem;margin-top:2px;flex-shrink:0}.comment-text[data-v-2e25d2c6]{color:var(--text-color);font-size:.9rem;line-height:1.4}.comment-text[data-v-2e25d2c6] img.inline-emoji{display:inline-block;vertical-align:middle;height:2em;width:auto;margin:0 .3em;max-height:32px}.comment-text[data-v-2e25d2c6] .spoiler-text{background:#333;color:transparent;cursor:pointer;user-select:none;transition:all .2s ease}.comment-text[data-v-2e25d2c6] .spoiler-text.revealed{background:none;color:inherit}.comment-text[data-v-2e25d2c6] .comment-link{color:var(--accent-color);text-decoration:none;transition:color .2s ease}.comment-text[data-v-2e25d2c6] .comment-link:hover{color:var(--accent-hover);text-decoration:underline}.movie-poster[data-v-2e25d2c6]{margin-right:8px;flex-shrink:0}.poster-img[data-v-2e25d2c6]{width:50px;height:75px;object-fit:cover;border-radius:4px;cursor:pointer;transition:transform .3s ease}.poster-img[data-v-2e25d2c6]:hover{transform:scale(1.05)}.notification-actions[data-v-2e25d2c6]{display:flex;flex-direction:column;gap:4px;flex-shrink:0}.action-btn[data-v-2e25d2c6]{width:28px;height:28px;border:none;border-radius:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;font-size:.8rem}.mark-read-btn[data-v-2e25d2c6]{background:var(--accent-color);color:#fff}.mark-read-btn[data-v-2e25d2c6]:hover{background:var(--accent-hover)}.delete-btn[data-v-2e25d2c6]{background:var(--error-color);color:#fff}.delete-btn[data-v-2e25d2c6]:hover{background:#d63031}.unread-indicator[data-v-2e25d2c6]{position:absolute;top:8px;right:8px;width:6px;height:6px;background:var(--error-color);border-radius:50%}@media (max-width: 768px){.notification-item[data-v-2e25d2c6]{padding:8px}.notification-content[data-v-2e25d2c6]{gap:6px}.notification-avatar[data-v-2e25d2c6]{width:32px;height:32px}.avatar-icon[data-v-2e25d2c6]{font-size:14px}.notification-header[data-v-2e25d2c6]{flex-direction:column;align-items:flex-start;gap:4px}.notification-info[data-v-2e25d2c6]{font-size:.9rem}.movie-poster[data-v-2e25d2c6]{margin-right:8px}.poster-img[data-v-2e25d2c6]{width:40px;height:60px}.notification-actions[data-v-2e25d2c6]{flex-direction:row;gap:4px}.action-btn[data-v-2e25d2c6]{width:24px;height:24px;font-size:.75rem}}[data-v-2e25d2c6]:root{--accent-color: #6c5ce7;--accent-hover: #5a4fcf;--secondary-color: #74b9ff;--secondary-hover: #0984e3;--text-color: #2d3436;--muted-color: #636e72;--error-color: #e17055}[data-theme=dark][data-v-2e25d2c6]{--text-color: #ddd;--muted-color: #999}.notifications-page[data-v-8a1f51b0]{min-height:100vh;background:var(--bg-gradient);padding:20px 0}.container[data-v-8a1f51b0]{max-width:800px;margin:0 auto;padding:0 20px}.notifications-header[data-v-8a1f51b0]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;flex-wrap:wrap;gap:15px}.page-title[data-v-8a1f51b0]{font-size:2.5rem;font-weight:700;color:var(--text-color);display:flex;align-items:center;gap:15px;margin:0}.page-title i[data-v-8a1f51b0]{color:var(--text-color)}.header-actions[data-v-8a1f51b0]{display:flex;gap:10px}.btn[data-v-8a1f51b0]{background:var(--accent-color);color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-size:.9rem;display:flex;align-items:center;gap:8px;transition:all .3s ease}.btn[data-v-8a1f51b0]:hover:not(:disabled){background:var(--accent-hover);transform:translateY(-2px)}.btn[data-v-8a1f51b0]:disabled{opacity:.6;cursor:not-allowed}.btn-secondary[data-v-8a1f51b0]{background:var(--secondary-color)}.btn-secondary[data-v-8a1f51b0]:hover:not(:disabled){background:var(--secondary-hover)}.loading-container[data-v-8a1f51b0]{text-align:center;padding:60px 20px}.loading-text[data-v-8a1f51b0]{margin-top:20px;color:var(--text-color);font-size:1.1rem}.empty-state[data-v-8a1f51b0]{text-align:center;padding:60px 20px}.empty-icon[data-v-8a1f51b0]{font-size:4rem;color:var(--muted-color);margin-bottom:20px}.empty-title[data-v-8a1f51b0]{font-size:1.8rem;color:var(--text-color);margin-bottom:10px}.empty-text[data-v-8a1f51b0]{color:var(--muted-color);font-size:1.1rem;line-height:1.5}.notifications-list[data-v-8a1f51b0]{display:flex;flex-direction:column;gap:15px}@media (max-width: 768px){.notifications-header[data-v-8a1f51b0]{flex-direction:column;align-items:flex-start}.page-title[data-v-8a1f51b0]{font-size:2rem}.header-actions[data-v-8a1f51b0]{width:100%}.btn[data-v-8a1f51b0]{flex:1;justify-content:center}}[data-v-8a1f51b0]:root{--bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);--accent-color: #6c5ce7;--accent-hover: #5a4fcf;--secondary-color: #74b9ff;--secondary-hover: #0984e3;--text-color: #2d3436;--muted-color: #636e72;--error-color: #e17055}[data-theme=dark][data-v-8a1f51b0]{--bg-gradient: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);--text-color: #ddd;--muted-color: #999}\n/*$vite$:1*/",document.head.appendChild(a);var S={class:"notification-content"},G={key:0,class:"movie-poster"},P=["src","alt"],N={class:"notification-main"},F={class:"notification-header"},I={class:"notification-info"},L={class:"notification-time"},M={class:"notification-message"},H={key:0,class:"comment-preview"},R={key:0,class:"original-comment"},$=["innerHTML"],q={key:1,class:"reply-comment"},A=["innerHTML"],D={class:"notification-actions"},Y={key:0,class:"unread-indicator"},U=o({__name:"NotificationItem",props:{notification:{type:Object,required:!0}},emits:["mark-read","delete"],setup(t,e){var a=e.emit,n=t,o=a,x=C().formatContent,b=t=>t?x(t):"",h=()=>{o("mark-read",n.notification.id)},y=()=>{o("delete",n.notification.id)};return(e,a)=>{var n=i("router-link");return c(),r("div",{class:g(["notification-item",{unread:!t.notification.is_read,read:t.notification.is_read}])},[d("div",S,[t.notification.movie_cover?(c(),r("div",G,[s(n,{to:`/movie/${t.notification.movie_id}`},{default:f(()=>[d("img",{src:t.notification.movie_cover,alt:t.notification.movie_title,class:"poster-img"},null,8,P)]),_:1},8,["to"])])):l("",!0),d("div",N,[d("div",F,[d("div",I,[s(n,{to:`/movie/${t.notification.movie_id}`,class:"movie-title"},{default:f(()=>[p(v(t.notification.movie_title),1)]),_:1},8,["to"])]),d("div",L,v(u(m)(t.notification.created_at)),1)]),d("div",M,v(t.notification.message),1),t.notification.comment_content||t.notification.reply_content?(c(),r("div",H,[t.notification.comment_content?(c(),r("div",R,[a[0]||(a[0]=d("i",{class:"fas fa-quote-left"},null,-1)),d("span",{class:"comment-text",innerHTML:b(t.notification.comment_content)},null,8,$)])):l("",!0),t.notification.reply_content?(c(),r("div",q,[a[1]||(a[1]=d("i",{class:"fas fa-reply"},null,-1)),d("span",{class:"comment-text",innerHTML:b(t.notification.reply_content)},null,8,A)])):l("",!0)])):l("",!0)]),d("div",D,[t.notification.is_read?l("",!0):(c(),r("button",{key:0,onClick:h,class:"action-btn mark-read-btn",title:"Отметить как прочитанное"},a[2]||(a[2]=[d("i",{class:"fas fa-check"},null,-1)]))),d("button",{onClick:y,class:"action-btn delete-btn",title:"Удалить уведомление"},a[3]||(a[3]=[d("i",{class:"fas fa-trash"},null,-1)]))])]),t.notification.is_read?l("",!0):(c(),r("div",Y))],2)}}},[["__scopeId","data-v-2e25d2c6"]]),B={class:"notifications-page"},J={class:"container"},K={class:"notifications-header"},Q={key:0,class:"header-actions"},V=["disabled"],W={key:0,class:"loading-container"},X={key:2,class:"empty-state"},Z={key:3,class:"notifications-list"},tt={__name:"NotificationsPage",setup(e){var a=x(),o=b(),i=w(),f=h(!1),v=y(()=>a.notifications);k(n(t().m(function e(){return t().w(function(t){for(;;)switch(t.n){case 0:if(o.token){t.n=1;break}return i.push("/login"),t.a(2);case 1:return t.n=2,C();case 2:g();case 3:return t.a(2)}},e)}))),_(()=>{m&&(clearInterval(m),m=null)});var m=null;function g(){m=setInterval(()=>{a.fetchUnreadCount()},3e5)}function C(){return S.apply(this,arguments)}function S(){return(S=n(t().m(function e(){return t().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,a.fetchNotifications();case 1:return t.a(2)}},e)}))).apply(this,arguments)}function G(){return P.apply(this,arguments)}function P(){return(P=n(t().m(function e(){var n;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return f.value=!0,t.p=1,t.n=2,a.markAsRead();case 2:t.n=4;break;case 3:t.p=3,n=t.v,console.error("Error marking all as read:",n);case 4:return t.p=4,f.value=!1,t.f(4);case 5:return t.a(2)}},e,null,[[1,3,4,5]])}))).apply(this,arguments)}function N(t){return F.apply(this,arguments)}function F(){return(F=n(t().m(function e(n){var o;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a.markAsRead([n]);case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.error("Error marking notification as read:",o);case 3:return t.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function I(t){return L.apply(this,arguments)}function L(){return(L=n(t().m(function e(n){var o;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a.deleteNotification(n);case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.error("Error deleting notification:",o);case 3:return t.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}return(t,e)=>(c(),r("div",B,[d("div",J,[d("div",K,[e[1]||(e[1]=d("h1",{class:"page-title"},[d("i",{class:"fas fa-bell"}),p(" Уведомления ")],-1)),v.value.length>0?(c(),r("div",Q,[u(a).unreadCount>0?(c(),r("button",{key:0,onClick:G,class:"btn",disabled:f.value},e[0]||(e[0]=[d("i",{class:"fas fa-check-double"},null,-1),p(" Отметить все как прочитанные ")]),8,V)):l("",!0)])):l("",!0)]),u(a).loading?(c(),r("div",W,[s(E),e[2]||(e[2]=d("p",{class:"loading-text"},"Загрузка уведомлений...",-1))])):u(a).error?(c(),j(z,{key:1,message:u(a).error,onRetry:C},null,8,["message"])):0===v.value.length?(c(),r("div",X,e[3]||(e[3]=[d("i",{class:"fas fa-bell-slash empty-icon"},null,-1),d("h3",{class:"empty-title"},"Нет уведомлений",-1),d("p",{class:"empty-text"}," Когда кто-то ответит на ваш комментарий, вы увидите уведомление здесь ",-1)]))):(c(),r("div",Z,[(c(!0),r(O,null,T(v.value,t=>(c(),j(U,{key:t.id,notification:t,onMarkRead:N,onDelete:I},null,8,["notification"]))),128))]))])]))}};e("default",o(tt,[["__scopeId","data-v-8a1f51b0"]]))}}})}();
