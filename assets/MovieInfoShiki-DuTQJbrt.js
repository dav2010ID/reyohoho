import{_ as O,ab as P,l as v,ac as Y,A as N,o as z,c as a,d as o,a4 as R,e as F,g as n,m as p,E as H,t as r,u as L,Y as W,f as j,n as f,D as h,ad as b,h as y,S as X,ah as G,b as s}from"./index-K9ILig-E.js";import{a as E,b as T}from"./icon-imdb-logo-5qtstUwS.js";import{P as D,M as J,_ as c,a as Q}from"./MovieRating-CFM4nd5u.js";import{S as Z}from"./SpinnerLoading-s9S-IcgQ.js";import"./ToastMessage-NDVIe7GU.js";import"./htmlSanitizer-Cf6jTOTR.js";import"./player-p5LVmN4e.js";const ee={class:"movie-info"},te={class:"content"},ie={key:0,class:"content-card"},oe={class:"movie-skeleton"},se={class:"movie-skeleton__player"},ae={key:2,class:"content-card"},ne={key:3,class:"content-card"},le={class:"content-header"},re=["src"],ve={class:"content-title"},de={key:0,class:"ratings-links"},ue={key:1},ce=["href","title"],_e={key:2},me=["href","title"],ke={key:3},ge=["href","title"],pe={key:4},fe=["href","title"],he={key:5},be=["href"],ye={class:"additional-info"},we={class:"info-content"},Me={key:0,class:"movie-poster-container"},xe=["src","alt"],Se={class:"details-container"},$e={class:"info-list"},Ce={key:0},Ie={key:1},Ne={key:2},Re={key:3},Ee={class:"content-info"},Te={key:0,class:"content-description-text"},De={__name:"MovieInfoShiki",setup(Ue){const _=v(!0),U=P(),w=X(),d=v(w.params.shiki_id),u=v(""),M=v(null),e=v(null),x=Y(),B=v(null),m=v(!1),S=v({}),$=i=>{m.value=!0,S.value={left:i.clientX+10+"px",top:i.clientY-30+"px"}},k=i=>i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(1)+"K":i.toString(),V=i=>{i.target.src="/src/assets/image-no-poster.gif"},C=async()=>{try{const i=[e.value.name_ru||e.value.name_en||e.value.name_original,...e.value.year?[e.value.year]:[],...e.value.film_length?[A(e.value.film_length)]:[]];await navigator.clipboard.writeText(i.join(", ")),B.value.showNotification("Скопировано")}catch(i){console.error("Ошибка копирования:",i)}},A=i=>{const t=Math.floor(i/60),l=i%60;return t>0?"".concat(t,"ч ").concat(l,"м"):"".concat(l,"м")},g=async()=>{try{_.value=!0;const i=await G(d.value);if(Array.isArray(i)&&i.length===0)throw new Error("Данные не найдены. Пожалуйста, повторите поиск.");if(e.value=i,e.value={...e.value,title:e.value.name_ru||e.value.name_en,name_original:e.value.name_en,short_description:e.value.slogan},x.setHeaderContent({text:e.value.title,imageUrl:e.value.logo_url}),I(),e.value.screenshots&&e.value.screenshots.length>0){const t=Math.floor(Math.random()*e.value.screenshots.length),l=e.value.screenshots[t];U.updateMoviePoster(l)}}catch(i){const{message:t,code:l}=q(i);u.value=t,M.value=l,console.error("Ошибка при загрузке информации о фильмах:",i)}finally{_.value=!1}},q=i=>{if(i.response){const t=i.response.status;let l="Произошла ошибка при загрузке данных",K=t;switch(t){case 404:l="Фильм не найден";break;case 403:l="Доступ запрещен";break;case 500:l="Ошибка сервера";break;default:l="Ошибка ".concat(t)}return{message:l,code:K}}else return i.request?{message:"Ошибка сети",code:"NETWORK_ERROR"}:{message:i.message||"Неизвестная ошибка",code:"UNKNOWN"}},I=()=>{var i;(i=e.value)!=null&&i.title&&(document.title="".concat(e.value.title," - ReYohoho"))};return N(()=>w.params.shiki_id,async i=>{i&&i!==d.value&&(x.clearHeaderContent(),d.value=i,await g())},{immediate:!0}),N(e,()=>{I()},{deep:!0}),z(()=>{e.value||g()}),(i,t)=>(s(),a("div",ee,[o("div",te,[(_.value||!e.value)&&!u.value?(s(),a("div",ie,[o("div",oe,[t[2]||(t[2]=R('<div class="movie-skeleton__header" data-v-162b319c><div class="movie-skeleton__title" data-v-162b319c></div></div><div class="movie-skeleton__ratings" data-v-162b319c><div class="movie-skeleton__rating-item" data-v-162b319c></div><div class="movie-skeleton__rating-item" data-v-162b319c></div><div class="movie-skeleton__rating-item" data-v-162b319c></div></div>',2)),o("div",se,[F(Z)]),t[3]||(t[3]=R('<div class="movie-skeleton__additional-info" data-v-162b319c><div class="movie-skeleton__section-title" data-v-162b319c></div><div class="movie-skeleton__info-list" data-v-162b319c><div class="movie-skeleton__info-item" data-v-162b319c></div><div class="movie-skeleton__info-item" data-v-162b319c></div><div class="movie-skeleton__info-item" data-v-162b319c></div><div class="movie-skeleton__info-item" data-v-162b319c></div><div class="movie-skeleton__info-item" data-v-162b319c></div></div></div><div class="movie-skeleton__description" data-v-162b319c><div class="movie-skeleton__description-line" data-v-162b319c></div><div class="movie-skeleton__description-line" data-v-162b319c></div><div class="movie-skeleton__description-line" data-v-162b319c></div><div class="movie-skeleton__description-line" data-v-162b319c></div></div>',2))])])):n("",!0),u.value?(s(),p(H,{key:1,message:u.value,code:M.value},null,8,["message","code"])):n("",!0),u.value?(s(),a("div",ae,[(s(),p(D,{key:d.value,"movie-info":e.value,"onUpdate:movieInfo":g},null,8,["movie-info"]))])):n("",!0),e.value&&!_.value?(s(),a("div",ne,[o("div",le,[e.value.logo_url?(s(),a("div",{key:0,class:"content-logo",onMousemove:$,onMouseleave:t[0]||(t[0]=l=>m.value=!1),onClick:C},[o("img",{src:e.value.logo_url,alt:"Логотип аниме",class:"content-logo"},null,8,re)],32)):(s(),a("div",{key:1,onMousemove:$,onMouseleave:t[1]||(t[1]=l=>m.value=!1),onClick:C},[o("h1",ve,r(e.value.title),1)],32)),L(o("div",{class:"title-copy-tooltip",style:j(S.value)}," Скопировать ",4),[[W,m.value]])]),e.value.kinopoisk_id||e.value.title||e.value.imdb_id||e.value.rating_imdb||e.value.shikimori_id?(s(),a("div",de,[e.value.kinopoisk_id?(s(),p(J,{key:e.value.kinopoisk_id,"kp-id":e.value.kinopoisk_id,"show-dash":!0},null,8,["kp-id"])):n("",!0),e.value.kinopoisk_id?(s(),a("div",ue,[o("a",{href:"https://www.kinopoisk.ru/film/".concat(e.value.kinopoisk_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:e.value.rating_kinopoisk_vote_count?"Оценок: ".concat(k(e.value.rating_kinopoisk_vote_count)):"Нет данных о количестве голосов"},[t[4]||(t[4]=o("img",{src:E,alt:"КП",class:"rating-logo"},null,-1)),o("span",{class:f(["rating-value",h(b)(e.value.rating_kinopoisk)])},r(e.value.rating_kinopoisk?e.value.rating_kinopoisk:"—"),3),t[5]||(t[5]=o("img",{src:c,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,ce)])):n("",!0),!e.value.kinopoisk_id&&e.value.title?(s(),a("div",_e,[o("a",{href:"https://www.kinopoisk.ru/index.php?kp_query=".concat(encodeURIComponent(e.value.title+(e.value.year?" "+e.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:e.value.rating_kinopoisk_vote_count?"Оценок: ".concat(k(e.value.rating_kinopoisk_vote_count)):"Нет данных о количестве голосов"},[t[6]||(t[6]=o("img",{src:E,alt:"КП",class:"rating-logo"},null,-1)),o("span",{class:f(["rating-value",h(b)(e.value.rating_kinopoisk)])},r(e.value.rating_kinopoisk?e.value.rating_kinopoisk:"—"),3),t[7]||(t[7]=o("img",{src:c,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,me)])):n("",!0),e.value.imdb_id?(s(),a("div",ke,[o("a",{href:"https://www.imdb.com/title/tt".concat(e.value.imdb_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:e.value.rating_imdb_vote_count?"Оценок: ".concat(k(e.value.rating_imdb_vote_count)):"Нет данных о количестве голосов"},[t[8]||(t[8]=o("img",{src:T,alt:"IMDb",class:"rating-logo"},null,-1)),o("span",{class:f(["rating-value",h(b)(e.value.rating_imdb)])},r(e.value.rating_imdb?e.value.rating_imdb:"—"),3),t[9]||(t[9]=o("img",{src:c,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,ge)])):n("",!0),!e.value.imdb_id&&e.value.title?(s(),a("div",pe,[o("a",{href:"https://www.imdb.com/find/?q=".concat(encodeURIComponent(e.value.title+(e.value.year?" "+e.value.year:""))),target:"_blank",rel:"noopener noreferrer",class:"rating-link",title:e.value.rating_imdb_vote_count?"Оценок: ".concat(k(e.value.rating_imdb_vote_count)):"Нет данных о количестве голосов"},[t[10]||(t[10]=o("img",{src:T,alt:"IMDb",class:"rating-logo"},null,-1)),o("span",{class:f(["rating-value",h(b)(e.value.rating_imdb)])},r(e.value.rating_imdb?e.value.rating_imdb:"—"),3),t[11]||(t[11]=o("img",{src:c,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1))],8,fe)])):n("",!0),e.value.shikimori_id?(s(),a("div",he,[o("a",{href:"https://shikimori.one/animes/".concat(e.value.shikimori_id),target:"_blank",rel:"noopener noreferrer",class:"rating-link"},[...t[12]||(t[12]=[o("img",{src:Q,alt:"Shiki",class:"rating-logo"},null,-1),o("img",{src:c,alt:"Внешняя ссылка",class:"external-link-icon"},null,-1)])],8,be)])):n("",!0)])):n("",!0),(s(),p(D,{key:d.value,"kp-id":d.value,"movie-info":e.value,"onUpdate:movieInfo":g},null,8,["kp-id","movie-info"])),o("div",ye,[t[17]||(t[17]=o("h2",{class:"additional-info-title"},"Подробнее",-1)),o("div",we,[e.value.screenshots&&e.value.screenshots.length>0?(s(),a("div",Me,[o("img",{src:e.value.screenshots[0],alt:e.value.title,class:"movie-poster",onError:V},null,40,xe)])):n("",!0),o("div",Se,[o("ul",$e,[e.value.year?(s(),a("li",Ce,[t[13]||(t[13]=o("strong",null,"Год:",-1)),y(" "+r(e.value.year),1)])):n("",!0),e.value.type?(s(),a("li",Ie,[t[14]||(t[14]=o("strong",null,"Тип:",-1)),y(" "+r(e.value.type),1)])):n("",!0),e.value.name_ru&&e.value.name_en?(s(),a("li",Ne,[t[15]||(t[15]=o("strong",null,"Оригинальное название:",-1)),y(" "+r(e.value.name_en),1)])):n("",!0),e.value.slogan?(s(),a("li",Re,[t[16]||(t[16]=o("strong",null,"Слоган:",-1)),y(" "+r(e.value.slogan),1)])):n("",!0)]),o("div",Ee,[e.value.description?(s(),a("p",Te,r(e.value.description),1)):n("",!0)])])])])])):n("",!0)])]))}},Ye=O(De,[["__scopeId","data-v-162b319c"]]);export{Ye as default};
