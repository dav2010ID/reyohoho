import{_ as h,c as n,d as t,u as g,t as N,h as C,B as w,C as k,g as x,x as L,l as d,o as U,a0 as _,q as B,$ as D,M as P,b as i}from"./index-B1GPPqJI.js";const R={name:"ProfilePage",setup(){const u=d(!1),e=L(),v=P(),o=d(e.user),c=d(null),r=d(!1),s=d(""),a=d(null),y=()=>{u.value=!0},m=async(l=!1)=>{u.value=!1,e.logout(),l?await v.push("/"):await v.push("/login"),v.go(0)},b=()=>{s.value=o.value.name,r.value=!0,D(()=>{var l,f;(l=a.value)==null||l.focus(),(f=a.value)==null||f.select()})},p=async()=>{if(s.value.trim()&&s.value.trim()!==o.value.name)try{await e.updateUserName(s.value.trim()),o.value.name=s.value.trim()}catch(l){console.error("Ошибка при обновлении имени:",l)}r.value=!1},E=()=>{r.value=!1,s.value=""};return U(async()=>{if(o.value||m(!0),o.value.photo){const l=await _();c.value="".concat(l).concat(o.value.photo)}}),{user:o,showDialog:u,confirmLogout:y,logout:m,photoURL:c,isEditingName:r,editingName:s,nameInput:a,startEditName:b,saveName:p,cancelEditName:E}}},S={class:"profile-container"},V={key:0,class:"profile-content"},I={class:"profile-photo"},M={key:0,alt:"Profile Photo"},T={key:1,class:"photo-placeholder"},z={class:"profile-info"},A={class:"info-item"},K={class:"editable-field"},q={key:1,class:"edit-input-container"},j={key:1,class:"loading"},F={key:2,class:"dialog-overlay"},G={class:"dialog modern-dark-dialog"},H={class:"dialog-footer"};function J(u,e,v,o,c,r){const s=B("lazy");return i(),n("div",S,[e[14]||(e[14]=t("div",{class:"profile-header"},[t("h1",null,"Профиль")],-1)),o.user?(i(),n("div",V,[t("div",I,[o.user.photo&&o.photoURL?g((i(),n("img",M,null,512)),[[s,o.photoURL]]):(i(),n("div",T,N(String.fromCodePoint(o.user.name.codePointAt(0)).toLocaleUpperCase()),1))]),t("div",z,[t("div",A,[e[11]||(e[11]=t("label",null,"Имя:",-1)),t("div",K,[o.isEditingName?(i(),n("div",q,[g(t("input",{ref:"nameInput","onUpdate:modelValue":e[1]||(e[1]=a=>o.editingName=a),class:"edit-input",maxlength:"50",onKeyup:[e[2]||(e[2]=k((...a)=>o.saveName&&o.saveName(...a),["enter"])),e[3]||(e[3]=k((...a)=>o.cancelEditName&&o.cancelEditName(...a),["esc"]))],onBlur:e[4]||(e[4]=(...a)=>o.saveName&&o.saveName(...a))},null,544),[[w,o.editingName]]),t("button",{class:"save-btn",onClick:e[5]||(e[5]=(...a)=>o.saveName&&o.saveName(...a))},"✓"),t("button",{class:"cancel-btn",onClick:e[6]||(e[6]=(...a)=>o.cancelEditName&&o.cancelEditName(...a))},"✕")])):(i(),n("span",{key:0,class:"editable-text",onClick:e[0]||(e[0]=(...a)=>o.startEditName&&o.startEditName(...a))},[C(N(o.user.name)+" ",1),e[10]||(e[10]=t("i",{class:"fas fa-edit edit-icon"},null,-1))]))])])]),t("button",{class:"logout-btn",onClick:e[7]||(e[7]=(...a)=>o.confirmLogout&&o.confirmLogout(...a))},"Выйти")])):(i(),n("div",j,"Загрузка профиля...")),o.showDialog?(i(),n("div",F,[t("div",G,[e[12]||(e[12]=t("div",{class:"dialog-header"},[t("h3",null,"Выход")],-1)),e[13]||(e[13]=t("div",{class:"dialog-body"},[t("p",null,"Вы уверены?")],-1)),t("div",H,[t("button",{class:"modern-dark-btn",onClick:e[8]||(e[8]=a=>o.showDialog=!1)},"Отмена"),t("button",{class:"modern-dark-btn danger",onClick:e[9]||(e[9]=(...a)=>o.logout&&o.logout(...a))},"Выйти")])])])):x("",!0)])}const Q=h(R,[["render",J],["__scopeId","data-v-27307cba"]]);export{Q as default};
