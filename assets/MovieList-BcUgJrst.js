import{_ as L,b as s,c as l,d,e as T,t as C,g,F as N,r as X,v as P,q as te,u as U,m as x,s as ae,n as D,D as B,ad as z,h as A,ae as Y,aU as I,k as y,aV as se,ab as G,aW as Q,o as p,p as ie,w as _,aX as oe,Y as F,aK as j,f as le,l as M,$ as q,x as re,M as ne,S as ue,A as ve,a as de,ak as ce,U as me,J as he}from"./index-DX7gZ8Uz.js";import{S as fe}from"./SpinnerLoading-B7RHnolp.js";import{_ as we,a as ge,b as ye}from"./icon-imdb-logo-5qtstUwS.js";const be={},ke={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 50 59",class:"bin"};function Se(e,h){return s(),l("svg",ke,[...h[0]||(h[0]=[d("path",{fill:"#B5BAC1",d:"M0 7.5C0 5.01472 2.01472 3 4.5 3H45.5C47.9853 3 50 5.01472 50 7.5V7.5C50 8.32843 49.3284 9 48.5 9H1.5C0.671571 9 0 8.32843 0 7.5V7.5Z"},null,-1),d("path",{fill:"#B5BAC1",d:"M17 3C17 1.34315 18.3431 0 20 0H29.3125C30.9694 0 32.3125 1.34315 32.3125 3V3H17V3Z"},null,-1),d("path",{fill:"#B5BAC1",d:"M2.18565 18.0974C2.08466 15.821 3.903 13.9202 6.18172 13.9202H43.8189C46.0976 13.9202 47.916 15.821 47.815 18.0975L46.1699 55.1775C46.0751 57.3155 44.314 59.0002 42.1739 59.0002H7.8268C5.68661 59.0002 3.92559 57.3155 3.83073 55.1775L2.18565 18.0974ZM18.0003 49.5402C16.6196 49.5402 15.5003 48.4209 15.5003 47.0402V24.9602C15.5003 23.5795 16.6196 22.4602 18.0003 22.4602C19.381 22.4602 20.5003 23.5795 20.5003 24.9602V47.0402C20.5003 48.4209 19.381 49.5402 18.0003 49.5402ZM29.5003 47.0402C29.5003 48.4209 30.6196 49.5402 32.0003 49.5402C33.381 49.5402 34.5003 48.4209 34.5003 47.0402V24.9602C34.5003 23.5795 33.381 22.4602 32.0003 22.4602C30.6196 22.4602 29.5003 23.5795 29.5003 24.9602V47.0402Z","clip-rule":"evenodd","fill-rule":"evenodd"},null,-1),d("path",{fill:"#B5BAC1",d:"M2 13H48L47.6742 21.28H2.32031L2 13Z"},null,-1)])])}const ee=L(be,[["render",Se]]),Ce={class:"deleteButton"},Me={__name:"DeleteButton",setup(e){return(h,r)=>(s(),l("button",Ce,[T(ee),r[0]||(r[0]=d("span",{class:"tooltip"},"Delete",-1))]))}},Be=L(Me,[["__scopeId","data-v-cd7aaf9f"]]),De={class:"movie-details"},Le={class:"movie-header"},$e={key:0,class:"original-title"},He={key:1,class:"meta"},xe={class:"year"},Te={key:2,class:"genres"},Ve={key:0,class:"genre-count"},Ee={__name:"CardMovieDetails",props:{movie:Object,isHistory:Boolean},setup(e){const h=r=>r&&r.replace(/\(\d{4}\)$/,"").trim();return(r,n)=>{var m,u,c,a;return s(),l("div",De,[d("div",Le,[d("h3",null,C(h(e.movie.title)),1)]),(m=e.movie.raw_data)!=null&&m.name_en||(u=e.movie.raw_data)!=null&&u.Name_original?(s(),l("div",$e,C(e.movie.raw_data.name_en||e.movie.raw_data.Name_original),1)):g("",!0),e.movie.year?(s(),l("div",He,[d("span",xe,C(e.movie.year),1)])):g("",!0),(a=(c=e.movie.raw_data)==null?void 0:c.genres)!=null&&a.length?(s(),l("div",Te,[(s(!0),l(N,null,X(e.movie.raw_data.genres.slice(0,2),t=>(s(),l("span",{key:t.genre,class:"genre-tag"},C(t.genre),1))),128)),e.movie.raw_data.genres.length>2?(s(),l("span",Ve," +"+C(e.movie.raw_data.genres.length-2),1)):g("",!0)])):g("",!0)])}}},Ue=L(Ee,[["__scopeId","data-v-95d5b656"]]),Ie={key:0},Re={class:"movie-poster"},ze={key:1,class:"ratings-overlay"},Ae={key:2,class:"poster-type"},Ye={key:3,class:"poster-type"},Ne={__name:"CardsMovieMainContent",props:I({movie:Object,isMobile:Boolean,isHistory:Boolean,isUserList:Boolean,showDelete:Boolean,showStar:Boolean},{isMobile:!1,isHistory:!1,isUserList:!1,showDelete:!0,showStar:!1}),emits:["remove:from-history"],setup(e,{emit:h}){const r=P(),n=y(()=>r.cardSize),m=h,u=y(()=>se(e.movie));return(c,a)=>{var b;const t=te("lazy");return s(),l("div",{class:D(["movie-poster-container","card-size-".concat(n.value)])},[u.value?(s(),l("div",Ie,[U(d("img",Re,null,512),[[t,u.value]]),!e.isMobile&&(e.isHistory||e.isUserList)&&e.showDelete?(s(),x(Be,{key:0,class:"delete-button","data-test-id":"delete-button",onClick:a[0]||(a[0]=ae(f=>m("remove:from-history",e.movie.kp_id),["stop","prevent"]))})):g("",!0),e.movie.rating_kp||e.movie.rating_imdb||e.movie.average_rating?(s(),l("div",ze,[e.movie.rating||e.movie.average_rating?(s(),l("span",{key:0,class:D(["rating-our",{"with-star":e.showStar,[B(z)(e.movie.rating||e.movie.average_rating)]:!0}])},[a[1]||(a[1]=d("img",{src:we,alt:"ReYohoho",class:"rating-logo"},null,-1)),A(" "+C("".concat((e.movie.rating||e.movie.average_rating).toFixed(1).replace(/\.0$/,""))),1)],2)):g("",!0),e.movie.rating_kp?(s(),l("span",{key:1,class:D(["rating-kp",B(z)(e.movie.rating_kp)])},[a[2]||(a[2]=d("img",{src:ge,alt:"ÐšÐŸ",class:"rating-logo"},null,-1)),A(" "+C(e.movie.rating_kp),1)],2)):g("",!0),e.movie.rating_imdb?(s(),l("span",{key:2,class:D(["rating-imdb",B(z)(e.movie.rating_imdb)])},[a[3]||(a[3]=d("img",{src:ye,alt:"IMDb",class:"rating-logo"},null,-1)),A(" "+C(e.movie.rating_imdb),1)],2)):g("",!0)])):g("",!0),e.movie.type&&B(Y)[e.movie.type]?(s(),l("div",Ae,C((b=B(Y)[e.movie.type])!=null?b:""),1)):g("",!0),e.movie.type&&!B(Y)[e.movie.type]?(s(),l("div",Ye,C(e.movie.type.replace("ðŸŽ¬","")),1)):g("",!0)])):g("",!0)],2)}}},Xe=L(Ne,[["__scopeId","data-v-1bd843e1"]]),Fe={__name:"CardMovie",props:I({movie:Object,isHistory:Boolean,isMobile:Boolean,isCardBorder:Boolean,isUserList:Boolean,index:Number,activeMovieIndex:[Number,null],showDelete:Boolean,showStar:Boolean},{isHistory:!1,isCardBorder:!1,isMobile:!1,isUserList:!1,activeMovieIndex:null,index:0,showDelete:!0,showStar:!1}),emits:["remove:from-history","save:element"],setup(e,{emit:h}){const r=G(),n=P(),m=y(()=>r.isCardHoverDisabled),u=y(()=>n.cardSize),c=h,a=Q("element");return p(()=>{a.value&&a.value.$el&&c("save:element",a.value.$el)}),(t,b)=>{const f=ie("RouterLink");return s(),x(f,{ref_key:"element",ref:a,class:D(["movie-card",{active:e.activeMovieIndex===e.index,"has-border":e.isCardBorder,"hover-disabled":m.value,"card-border":e.isCardBorder,["card-size-".concat(u.value)]:!0}]),to:{name:"movie-info",params:{kp_id:e.movie.kp_id}},"data-test-id":"movie-card-".concat(e.movie.kp_id),tabindex:"0"},{default:_(()=>[T(Xe,{movie:e.movie,"is-history":e.isHistory,"is-mobile":e.isMobile,"is-user-list":e.isUserList,"show-delete":e.showDelete,"show-star":e.showStar,"onRemove:fromHistory":b[0]||(b[0]=k=>c("remove:from-history",k))},null,8,["movie","is-history","is-mobile","is-user-list","show-delete","show-star"]),T(Ue,{movie:e.movie,"is-history":e.isHistory},null,8,["movie","is-history"])]),_:1},8,["class","to","data-test-id"])}}},J=L(Fe,[["__scopeId","data-v-16d92669"]]),Pe={class:"icon-container"},Ze={__name:"CardMovieSwipeWrapper",props:I({thresholdPercent:Number,disabled:Boolean,backgroundSwipeColor:String,showDelete:Boolean},{thresholdPercent:55,disabled:!1,backgroundSwipeColor:"#e53935",showDelete:!0}),emits:["slide"],setup(e,{emit:h}){oe(o=>({v383316c0:e.backgroundSwipeColor}));const r=h,n=Q("swipeElement"),m=M(0),u=M(0),c=M(0),a=M(0),t=M(!1),b=M(0),f=M(!1),k=y(()=>u.value-m.value),$=y(()=>a.value-c.value),R=y(()=>t.value?k.value:0),V=y(()=>b.value*e.thresholdPercent/100);function H(o){var v,w;e.disabled||!e.showDelete||(b.value=(w=(v=n.value)==null?void 0:v.offsetWidth)!=null?w:0,m.value=o.touches[0].clientX,c.value=o.touches[0].clientY,u.value=m.value,a.value=c.value,t.value=!1,f.value=!1)}function E(o){if(e.disabled||f.value||!e.showDelete)return;u.value=o.touches[0].clientX,a.value=o.touches[0].clientY;const v=Math.abs(k.value),w=Math.abs($.value);!t.value&&!f.value&&(w>v?(f.value=!0,t.value=!1):v>w&&v>10&&(t.value=!0)),t.value&&o.preventDefault()}function i(){if(e.disabled||!t.value||!e.showDelete){S();return}if(k.value<-V.value){t.value=!1,q(()=>{n.value.style.transform="translateX(-100%)",n.value.style.opacity="0"}),setTimeout(()=>{r("slide"),S()},300);return}if(k.value>V.value){t.value=!1,q(()=>{n.value.style.transform="translateX(100%)",n.value.style.opacity="0"}),setTimeout(()=>{r("slide"),S()},300);return}S()}function S(){m.value=0,u.value=0,c.value=0,a.value=0,t.value=!1,f.value=!1,n.value&&(n.value.style.transform="",n.value.style.opacity="")}return(o,v)=>(s(),l("div",{class:"swipe-container",onTouchstart:H,onTouchmove:E,onTouchend:i},[U(d("div",{class:D(["swipe-background",{"swipe-left":k.value>0,"swipe-right":k.value<0}])},[U(d("div",Pe,[j(o.$slots,"swipe-icon",{},()=>[T(ee)])],512),[[F,m.value]])],2),[[F,!e.disabled&&!f.value]]),d("div",{ref_key:"swipeElement",ref:n,"data-test-id":"swipe-ref-element",class:D(["swipe-wrapper",{swiping:t.value}]),style:le({transform:"translateX(".concat(R.value,"px)"),transition:t.value?"none":"transform 0.3s ease, opacity 0.3s ease"})},[j(o.$slots,"default",{},void 0)],6)],32))}},Ke=L(Ze,[["__scopeId","data-v-0467ed6e"]]),Oe={__name:"MovieList",props:I({moviesList:Array,isHistory:Boolean,loading:Boolean,showDelete:Boolean,showStar:Boolean},{isHistory:!1,loading:!0,showDelete:!0,showStar:!1}),emits:["item-deleted"],setup(e,{emit:h}){const r=P(),n=re(),m=G(),u=ne(),c=ue(),a=M([]),t=M(null),b=y(()=>m.isCardBorder),f=y(()=>r.isMobile),k=y(()=>r.cardSize),$=y(()=>{var i;return c.name==="lists"&&(!c.params.user_id||String(c.params.user_id)===String((i=n.user)==null?void 0:i.id))}),R=i=>u.resolve({name:"movie-info",params:{kp_id:i.kp_id}}).href,V=h,H=async i=>{if(n.token)try{await ce(i,me.HISTORY),V("item-deleted",i)}catch(S){const{code:o}=he(S);console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸:",S),o===401&&(n.logout(),await u.push("/login"),u.go(0))}else r.removeFromHistory(i)},E=i=>{var w,Z,K,O;if(!((w=e.moviesList)!=null&&w.length)||!((K=(Z=i.target)==null?void 0:Z.classList)!=null&&K.contains("movie-card")))return;const S=document.querySelector(".grid"),v=window.getComputedStyle(S).gridTemplateColumns.split(" ").length;switch(i.key){case"ArrowRight":t.value=(t.value+1)%e.moviesList.length;break;case"ArrowLeft":t.value=(t.value-1+e.moviesList.length)%e.moviesList.length;break;case"ArrowUp":if(i.preventDefault(),t.value<=0){const W=document.querySelector(".search-input");W&&W.focus()}else t.value=Math.max(t.value-v,0);break;case"ArrowDown":i.preventDefault(),t.value=Math.min(t.value+v,e.moviesList.length-1);break;case"Home":t.value=0;break;case"End":t.value=e.moviesList.length-1;break;case"Enter":i.ctrlKey||i.metaKey?(i.preventDefault(),window.open(R(e.moviesList[t.value]),"_blank")):u.push({name:"movie-info",params:{kp_id:(O=e.moviesList[t.value])==null?void 0:O.kp_id}});break}};return ve(t,i=>{a.value[i]&&(a.value[i].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),a.value[i].focus())}),p(()=>{document.addEventListener("keydown",E)}),de(()=>{document.removeEventListener("keydown",E)}),(i,S)=>(s(),l("div",null,[U(d("div",{class:D(["grid","card-size-".concat(k.value)])},[(e.isHistory||$.value)&&f.value?(s(!0),l(N,{key:0},X(e.moviesList,(o,v)=>(s(),x(B(Ke),{key:o.kp_id,"data-test-id":"movie-card-swipe-wrapper-".concat(o.kp_id),"show-delete":e.showDelete,onSlide:w=>H(o.kp_id)},{default:_(()=>[T(B(J),{movie:o,"is-history":e.isHistory,"is-mobile":f.value,"is-user-list":$.value,index:v,"is-card-border":b.value,"active-movie-index":t.value,"show-delete":e.showDelete,"show-star":e.showStar,"onRemove:fromHistory":H,"onSave:element":w=>a.value[v]=w},null,8,["movie","is-history","is-mobile","is-user-list","index","is-card-border","active-movie-index","show-delete","show-star","onSave:element"])]),_:2},1032,["data-test-id","show-delete","onSlide"]))),128)):(s(!0),l(N,{key:1},X(e.moviesList,(o,v)=>(s(),x(B(J),{key:o.kp_id,movie:o,"is-history":e.isHistory,"is-mobile":f.value,"is-user-list":$.value,index:v,"is-card-border":b.value,"active-movie-index":t.value,"show-delete":e.showDelete,"show-star":e.showStar,"onRemove:fromHistory":H,"onSave:element":w=>a.value[v]=w},null,8,["movie","is-history","is-mobile","is-user-list","index","is-card-border","active-movie-index","show-delete","show-star","onSave:element"]))),128))],2),[[F,!e.loading]]),e.loading?(s(),x(fe,{key:0})):g("",!0)]))}},Je=L(Oe,[["__scopeId","data-v-8e95405f"]]);export{Be as D,Je as M};
