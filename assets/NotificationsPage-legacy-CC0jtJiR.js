!function(){function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var a,n,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",r=o.toStringTag||"@@toStringTag";function c(t,o,i,r){var c=o&&o.prototype instanceof s?o:s,d=Object.create(c.prototype);return e(d,"_invoke",function(t,e,o){var i,r,c,s=0,d=o||[],f=!1,b={p:0,n:0,v:a,a:p,f:p.bind(a,4),d:function(t,e){return i=t,r=0,c=a,b.n=e,l}};function p(t,e){for(r=t,c=e,n=0;!f&&s&&!o&&n<d.length;n++){var o,i=d[n],p=b.p,v=i[2];t>3?(o=v===e)&&(c=i[(r=i[4])?5:(r=3,3)],i[4]=i[5]=a):i[0]<=p&&((o=t<2&&p<i[1])?(r=0,b.v=e,b.n=i[1]):p<v&&(o=t<3||i[0]>e||e>v)&&(i[4]=t,i[5]=e,b.n=v,r=0))}if(o||t>1)return l;throw f=!0,e}return function(o,d,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===d&&p(d,v),r=d,c=v;(n=r<2?a:c)||!f;){i||(r?r<3?(r>1&&(b.n=-1),p(r,c)):b.n=c:b.v=c);try{if(s=2,i){if(r||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,r<2&&(r=0)}else 1===r&&(n=i.return)&&n.call(i),r<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),r=1);i=a}else if((n=(f=b.n<0)?c:t.call(e,b))!==l)break}catch(n){i=a,r=1,c=n}finally{s=1}}return{value:n,done:f}}}(t,i,r),!0),d}var l={};function s(){}function d(){}function f(){}n=Object.getPrototypeOf;var b=[][i]?n(n([][i]())):(e(n={},i,function(){return this}),n),p=f.prototype=s.prototype=Object.create(b);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,r,"GeneratorFunction")),t.prototype=Object.create(p),t}return d.prototype=f,e(p,"constructor",f),e(f,"constructor",d),d.displayName="GeneratorFunction",e(f,r,"GeneratorFunction"),e(p),e(p,r,"Generator"),e(p,i,function(){return this}),e(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:c,m:v}})()}function e(t,a,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}e=function(t,a,n,o){function r(a,n){e(t,a,function(t){return this._invoke(a,n,t)})}a?i?i(t,a,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[a]=n:(r("next",0),r("throw",1),r("return",2))},e(t,a,n,o)}function a(t,e,a,n,o,i,r){try{var c=t[i](r),l=c.value}catch(t){return void a(t)}c.done?e(l):Promise.resolve(l).then(n,o)}function n(t){return function(){var e=this,n=arguments;return new Promise(function(o,i){var r=t.apply(e,n);function c(t){a(r,o,i,c,l,"next",t)}function l(t){a(r,o,i,c,l,"throw",t)}c(void 0)})}}System.register(["./index-legacy-u9UkpSeE.js","./useCommentFormatting-legacy-r_EoyfUF.js","./SpinnerLoading-legacy-DTeiSfa8.js","./htmlSanitizer-legacy-BuNrU8dK.js"],function(e,a){"use strict";var o,i,r,c,l,s,d,f,b,p,v,u,m,g,x,h,y,k,w,_,j,z,O,C,T,S;return{setters:[t=>{o=t._,i=t.p,r=t.b,c=t.c,l=t.d,s=t.e,d=t.w,f=t.g,b=t.h,p=t.t,v=t.D,u=t.a2,m=t.n,g=t.aN,x=t.x,h=t.o,y=t.a,k=t.m,w=t.E,_=t.F,j=t.r,z=t.M,O=t.k,C=t.l},t=>{T=t.u},t=>{S=t.S},null],execute:function(){var a=document.createElement("style");a.textContent=".notification-item[data-v-3b833b4e]{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border-radius:8px;padding:10px;position:relative;transition:all .3s ease;border:1px solid rgba(255,255,255,.1)}.notification-item[data-v-3b833b4e]:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.1)}.notification-item.unread[data-v-3b833b4e]{background:rgba(255,255,255,.1);border-color:var(--accent-color)}.notification-content[data-v-3b833b4e]{display:flex;gap:8px;align-items:flex-start}.notification-avatar[data-v-3b833b4e]{flex-shrink:0;width:40px;height:40px;border-radius:50%;overflow:hidden;background:var(--accent-color);display:flex;align-items:center;justify-content:center}.avatar-img[data-v-3b833b4e]{width:100%;height:100%;object-fit:cover}.avatar-icon[data-v-3b833b4e]{color:#fff;font-size:18px}.notification-main[data-v-3b833b4e]{flex:1;min-width:0}.notification-header[data-v-3b833b4e]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:4px;gap:8px}.notification-info[data-v-3b833b4e]{display:flex;flex-wrap:wrap;gap:4px;align-items:center}.sender-name[data-v-3b833b4e]{font-weight:600;color:var(--text-color)}.notification-type[data-v-3b833b4e]{color:var(--text-color)}.movie-title[data-v-3b833b4e]{color:var(--text-color);font-weight:500;text-decoration:underline;display:inline}.movie-title[data-v-3b833b4e]:hover{color:var(--text-color)}.notification-time[data-v-3b833b4e]{color:var(--muted-color);font-size:.85rem;white-space:nowrap}.notification-message[data-v-3b833b4e]{color:var(--text-color);margin-bottom:6px;font-weight:500;font-size:.95rem}.comment-preview[data-v-3b833b4e]{background:rgba(255,255,255,.05);border-radius:6px;padding:8px;margin-bottom:6px;border-left:2px solid var(--accent-color)}.original-comment[data-v-3b833b4e],.reply-comment[data-v-3b833b4e]{display:flex;align-items:flex-start;gap:8px;margin-bottom:6px}.original-comment[data-v-3b833b4e]:last-child,.reply-comment[data-v-3b833b4e]:last-child{margin-bottom:0}.comment-preview i[data-v-3b833b4e]{color:var(--muted-color);font-size:.8rem;margin-top:2px;flex-shrink:0}.comment-text[data-v-3b833b4e]{color:var(--text-color);font-size:.9rem;line-height:1.4}.comment-text[data-v-3b833b4e] img.inline-emoji{display:inline-block;vertical-align:middle;height:2em;width:auto;margin:0 .3em;max-height:32px}.comment-text[data-v-3b833b4e] .spoiler-text{background:#333;color:transparent;cursor:pointer;user-select:none;transition:all .2s ease}.comment-text[data-v-3b833b4e] .spoiler-text.revealed{background:none;color:inherit}.comment-text[data-v-3b833b4e] .comment-link{color:var(--accent-color);text-decoration:none;transition:color .2s ease}.comment-text[data-v-3b833b4e] .comment-link:hover{color:var(--accent-hover);text-decoration:underline}.movie-poster[data-v-3b833b4e]{margin-right:8px;flex-shrink:0}.poster-img[data-v-3b833b4e]{width:50px;height:75px;object-fit:cover;border-radius:4px;cursor:pointer;transition:transform .3s ease}.poster-img[data-v-3b833b4e]:hover{transform:scale(1.05)}.notification-actions[data-v-3b833b4e]{display:flex;flex-direction:column;gap:4px;flex-shrink:0}.action-btn[data-v-3b833b4e]{width:28px;height:28px;border:none;border-radius:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;font-size:.8rem}.mark-read-btn[data-v-3b833b4e]{background:var(--accent-color);color:#fff}.mark-read-btn[data-v-3b833b4e]:hover{background:var(--accent-hover)}.delete-btn[data-v-3b833b4e]{background:var(--error-color);color:#fff}.delete-btn[data-v-3b833b4e]:hover{background:#d63031}.unread-indicator[data-v-3b833b4e]{position:absolute;top:8px;right:8px;width:6px;height:6px;background:var(--error-color);border-radius:50%}@media(max-width:768px){.notification-item[data-v-3b833b4e]{padding:8px}.notification-content[data-v-3b833b4e]{gap:6px}.notification-avatar[data-v-3b833b4e]{width:32px;height:32px}.avatar-icon[data-v-3b833b4e]{font-size:14px}.notification-header[data-v-3b833b4e]{flex-direction:column;align-items:flex-start;gap:4px}.notification-info[data-v-3b833b4e]{font-size:.9rem}.movie-poster[data-v-3b833b4e]{margin-right:8px}.poster-img[data-v-3b833b4e]{width:40px;height:60px}.notification-actions[data-v-3b833b4e]{flex-direction:row;gap:4px}.action-btn[data-v-3b833b4e]{width:24px;height:24px;font-size:.75rem}}[data-v-3b833b4e]:root{--accent-color: #6c5ce7;--accent-hover: #5a4fcf;--secondary-color: #74b9ff;--secondary-hover: #0984e3;--text-color: #2d3436;--muted-color: #636e72;--error-color: #e17055}[data-theme=dark][data-v-3b833b4e]{--text-color: #ddd;--muted-color: #999}.notifications-page[data-v-322b1869]{min-height:100vh;background:var(--bg-gradient);padding:20px 0}.container[data-v-322b1869]{max-width:800px;margin:0 auto;padding:0 20px}.notifications-header[data-v-322b1869]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;flex-wrap:wrap;gap:15px}.page-title[data-v-322b1869]{font-size:2.5rem;font-weight:700;color:var(--text-color);display:flex;align-items:center;gap:15px;margin:0}.page-title i[data-v-322b1869]{color:var(--text-color)}.header-actions[data-v-322b1869]{display:flex;gap:10px}.btn[data-v-322b1869]{background:var(--accent-color);color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-size:.9rem;display:flex;align-items:center;gap:8px;transition:all .3s ease}.btn[data-v-322b1869]:hover:not(:disabled){background:var(--accent-hover);transform:translateY(-2px)}.btn[data-v-322b1869]:disabled{opacity:.6;cursor:not-allowed}.btn-secondary[data-v-322b1869]{background:var(--secondary-color)}.btn-secondary[data-v-322b1869]:hover:not(:disabled){background:var(--secondary-hover)}.loading-container[data-v-322b1869]{text-align:center;padding:60px 20px}.loading-text[data-v-322b1869]{margin-top:20px;color:var(--text-color);font-size:1.1rem}.empty-state[data-v-322b1869]{text-align:center;padding:60px 20px}.empty-icon[data-v-322b1869]{font-size:4rem;color:var(--muted-color);margin-bottom:20px}.empty-title[data-v-322b1869]{font-size:1.8rem;color:var(--text-color);margin-bottom:10px}.empty-text[data-v-322b1869]{color:var(--muted-color);font-size:1.1rem;line-height:1.5}.notifications-list[data-v-322b1869]{display:flex;flex-direction:column;gap:15px}@media(max-width:768px){.notifications-header[data-v-322b1869]{flex-direction:column;align-items:flex-start}.page-title[data-v-322b1869]{font-size:2rem}.header-actions[data-v-322b1869]{width:100%}.btn[data-v-322b1869]{flex:1;justify-content:center}}[data-v-322b1869]:root{--bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);--accent-color: #6c5ce7;--accent-hover: #5a4fcf;--secondary-color: #74b9ff;--secondary-hover: #0984e3;--text-color: #2d3436;--muted-color: #636e72;--error-color: #e17055}[data-theme=dark][data-v-322b1869]{--bg-gradient: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);--text-color: #ddd;--muted-color: #999}\n/*$vite$:1*/",document.head.appendChild(a);var E={class:"notification-content"},P={key:0,class:"movie-poster"},G=["src","alt"],L={class:"notification-main"},M={class:"notification-header"},N={class:"notification-info"},F={class:"notification-time"},I={class:"notification-message"},H={key:0,class:"original-comment"},R=["innerHTML"],$={key:1,class:"reply-comment"},q=["innerHTML"],A={class:"notification-actions"},D={key:0,class:"unread-indicator"},Y=o({__name:"NotificationItem",props:{notification:{type:Object,required:!0}},emits:["mark-read","delete"],setup(t,e){var a=e.emit,n=t,o=a,g=T().formatContent,x=t=>t?g(t):"",h=()=>{o("mark-read",n.notification.id)},y=()=>{o("delete",n.notification.id)},k=t=>{var e=t.target.closest(".spoiler-text");e&&e.classList.toggle("revealed")};return(e,a)=>{var n=i("router-link");return r(),c("div",{class:m(["notification-item",{unread:!t.notification.is_read,read:t.notification.is_read}])},[l("div",E,[t.notification.movie_cover?(r(),c("div",P,[s(n,{to:`/movie/${t.notification.movie_id}`},{default:d(()=>[l("img",{src:t.notification.movie_cover,alt:t.notification.movie_title,class:"poster-img"},null,8,G)]),_:1},8,["to"])])):f("",!0),l("div",L,[l("div",M,[l("div",N,[s(n,{to:`/movie/${t.notification.movie_id}`,class:"movie-title"},{default:d(()=>[b(p(t.notification.movie_title),1)]),_:1},8,["to"])]),l("div",F,p(v(u)(t.notification.created_at)),1)]),l("div",I,p(t.notification.message),1),t.notification.comment_content||t.notification.reply_content?(r(),c("div",{key:0,class:"comment-preview",onClick:k},[t.notification.comment_content?(r(),c("div",H,[a[0]||(a[0]=l("i",{class:"fas fa-quote-left"},null,-1)),l("span",{class:"comment-text",innerHTML:x(t.notification.comment_content)},null,8,R)])):f("",!0),t.notification.reply_content?(r(),c("div",$,[a[1]||(a[1]=l("i",{class:"fas fa-reply"},null,-1)),l("span",{class:"comment-text",innerHTML:x(t.notification.reply_content)},null,8,q)])):f("",!0)])):f("",!0)]),l("div",A,[t.notification.is_read?f("",!0):(r(),c("button",{key:0,class:"action-btn mark-read-btn",title:"Отметить как прочитанное",onClick:h},[...a[2]||(a[2]=[l("i",{class:"fas fa-check"},null,-1)])])),l("button",{class:"action-btn delete-btn",title:"Удалить уведомление",onClick:y},[...a[3]||(a[3]=[l("i",{class:"fas fa-trash"},null,-1)])])])]),t.notification.is_read?f("",!0):(r(),c("div",D))],2)}}},[["__scopeId","data-v-3b833b4e"]]),U={class:"notifications-page"},B={class:"container"},J={class:"notifications-header"},K={key:0,class:"header-actions"},Q=["disabled"],V={key:0,class:"loading-container"},W={key:2,class:"empty-state"},X={key:3,class:"notifications-list"},Z={__name:"NotificationsPage",setup(e){var a=g(),o=x(),i=z(),d=C(!1),p=O(()=>a.notifications);h(n(t().m(function e(){return t().w(function(t){for(;;)switch(t.n){case 0:if(o.token){t.n=1;break}return i.push("/login"),t.a(2);case 1:return t.n=2,T();case 2:m();case 3:return t.a(2)}},e)}))),y(()=>{u&&(clearInterval(u),u=null)});var u=null;function m(){u=setInterval(()=>{a.fetchUnreadCount()},3e5)}function T(){return E.apply(this,arguments)}function E(){return(E=n(t().m(function e(){return t().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,a.fetchNotifications();case 1:return t.a(2)}},e)}))).apply(this,arguments)}function P(){return G.apply(this,arguments)}function G(){return(G=n(t().m(function e(){var n;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return d.value=!0,t.p=1,t.n=2,a.markAsRead();case 2:t.n=4;break;case 3:t.p=3,n=t.v,console.error("Error marking all as read:",n);case 4:return t.p=4,d.value=!1,t.f(4);case 5:return t.a(2)}},e,null,[[1,3,4,5]])}))).apply(this,arguments)}function L(t){return M.apply(this,arguments)}function M(){return(M=n(t().m(function e(n){var o;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a.markAsRead([n]);case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.error("Error marking notification as read:",o);case 3:return t.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function N(t){return F.apply(this,arguments)}function F(){return(F=n(t().m(function e(n){var o;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a.deleteNotification(n);case 1:t.n=3;break;case 2:t.p=2,o=t.v,console.error("Error deleting notification:",o);case 3:return t.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}return(t,e)=>(r(),c("div",U,[l("div",B,[l("div",J,[e[1]||(e[1]=l("h1",{class:"page-title"},[l("i",{class:"fas fa-bell"}),b(" Уведомления ")],-1)),p.value.length>0?(r(),c("div",K,[v(a).unreadCount>0?(r(),c("button",{key:0,class:"btn",disabled:d.value,onClick:P},[...e[0]||(e[0]=[l("i",{class:"fas fa-check-double"},null,-1),b(" Отметить все как прочитанные ",-1)])],8,Q)):f("",!0)])):f("",!0)]),v(a).loading?(r(),c("div",V,[s(S),e[2]||(e[2]=l("p",{class:"loading-text"},"Загрузка уведомлений...",-1))])):v(a).error?(r(),k(w,{key:1,message:v(a).error,onRetry:T},null,8,["message"])):0===p.value.length?(r(),c("div",W,[...e[3]||(e[3]=[l("i",{class:"fas fa-bell-slash empty-icon"},null,-1),l("h3",{class:"empty-title"},"Нет уведомлений",-1),l("p",{class:"empty-text"}," Когда кто-то ответит на ваш комментарий, вы увидите уведомление здесь ",-1)])])):(r(),c("div",X,[(r(!0),c(_,null,j(p.value,t=>(r(),k(Y,{key:t.id,notification:t,onMarkRead:L,onDelete:N},null,8,["notification"]))),128))]))])]))}};e("default",o(Z,[["__scopeId","data-v-322b1869"]]))}}})}();
