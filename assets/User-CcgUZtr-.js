import{_ as C,b as n,d as a,j as h,u as g,q as w,t as N,l as x,B as L,C as k,r,x as U,o as _,a0 as B,G as D,$ as P,i}from"./index-DQgqlGm1.js";const R={name:"ProfilePage",setup(){const u=r(!1),e=U(),v=D(),o=r(e.user),m=r(null),d=r(!1),s=r(""),t=r(null),y=()=>{u.value=!0},c=async(l=!1)=>{u.value=!1,e.logout(),l?await v.push("/"):await v.push("/login"),v.go(0)},b=()=>{s.value=o.value.name,d.value=!0,P(()=>{var l,f;(l=t.value)==null||l.focus(),(f=t.value)==null||f.select()})},p=async()=>{if(s.value.trim()&&s.value.trim()!==o.value.name)try{await e.updateUserName(s.value.trim()),o.value.name=s.value.trim()}catch(l){console.error("Ошибка при обновлении имени:",l)}d.value=!1},E=()=>{d.value=!1,s.value=""};return _(async()=>{if(o.value||c(!0),o.value.photo){const l=await B();m.value="".concat(l).concat(o.value.photo)}}),{user:o,showDialog:u,confirmLogout:y,logout:c,photoURL:m,isEditingName:d,editingName:s,nameInput:t,startEditName:b,saveName:p,cancelEditName:E}}},S={class:"profile-container"},V={key:0,class:"profile-content"},I={class:"profile-photo"},T={key:0,alt:"Profile Photo"},z={key:1,class:"photo-placeholder"},A={class:"profile-info"},K={class:"info-item"},M={class:"editable-field"},j={key:1,class:"edit-input-container"},q={key:1,class:"loading"},G={key:2,class:"dialog-overlay"},F={class:"dialog modern-dark-dialog"},H={class:"dialog-footer"};function J(u,e,v,o,m,d){const s=w("lazy");return i(),n("div",S,[e[14]||(e[14]=a("div",{class:"profile-header"},[a("h1",null,"Профиль")],-1)),o.user?(i(),n("div",V,[a("div",I,[o.user.photo&&o.photoURL?g((i(),n("img",T,null,512)),[[s,o.photoURL]]):(i(),n("div",z,N(String.fromCodePoint(o.user.name.codePointAt(0)).toLocaleUpperCase()),1))]),a("div",A,[a("div",K,[e[11]||(e[11]=a("label",null,"Имя:",-1)),a("div",M,[o.isEditingName?(i(),n("div",j,[g(a("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>o.editingName=t),onKeyup:[e[2]||(e[2]=k((...t)=>o.saveName&&o.saveName(...t),["enter"])),e[3]||(e[3]=k((...t)=>o.cancelEditName&&o.cancelEditName(...t),["esc"]))],onBlur:e[4]||(e[4]=(...t)=>o.saveName&&o.saveName(...t)),ref:"nameInput",class:"edit-input",maxlength:"50"},null,544),[[L,o.editingName]]),a("button",{onClick:e[5]||(e[5]=(...t)=>o.saveName&&o.saveName(...t)),class:"save-btn"},"✓"),a("button",{onClick:e[6]||(e[6]=(...t)=>o.cancelEditName&&o.cancelEditName(...t)),class:"cancel-btn"},"✕")])):(i(),n("span",{key:0,onClick:e[0]||(e[0]=(...t)=>o.startEditName&&o.startEditName(...t)),class:"editable-text"},[x(N(o.user.name)+" ",1),e[10]||(e[10]=a("i",{class:"fas fa-edit edit-icon"},null,-1))]))])])]),a("button",{class:"logout-btn",onClick:e[7]||(e[7]=(...t)=>o.confirmLogout&&o.confirmLogout(...t))},"Выйти")])):(i(),n("div",q,"Загрузка профиля...")),o.showDialog?(i(),n("div",G,[a("div",F,[e[12]||(e[12]=a("div",{class:"dialog-header"},[a("h3",null,"Выход")],-1)),e[13]||(e[13]=a("div",{class:"dialog-body"},[a("p",null,"Вы уверены?")],-1)),a("div",H,[a("button",{class:"modern-dark-btn",onClick:e[8]||(e[8]=t=>o.showDialog=!1)},"Отмена"),a("button",{class:"modern-dark-btn danger",onClick:e[9]||(e[9]=(...t)=>o.logout&&o.logout(...t))},"Выйти")])])])):h("",!0)])}const Q=C(R,[["render",J],["__scopeId","data-v-9f2337e0"]]);export{Q as default};
