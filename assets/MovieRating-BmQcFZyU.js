import{_ as qt,r as p,c as le,b as S,i as w,d as n,l as Ke,t as b,F as De,f as ot,n as L,j as ie,s as dt,v as ro,x as Xo,S as Jo,G as co,A as Qe,o as uo,X as Zo,m as Lt,E as Qo,e as Dt,k as no,u as ne,Y as se,D as be,U as Y,aB as en,aC as tn,K as so,$ as _t,aD as io,aE as on,al as nn,aj as sn,ad as lo,au as et,ae as ln,aF as an,aG as ao}from"./index-8FNVx0O0.js";import{S as rn}from"./SpinnerLoading-C0Gs6Gi3.js";import{N as vo}from"./ToastMessage-DKWR0Jji.js";import{u as cn,S as un}from"./player-CqAQgQI4.js";import{_ as dn}from"./icon-imdb-logo-5qtstUwS.js";const qs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVR4nO2ZQUoDMRSGR7eewHoFsVS0HkUUXNXqASqK2EURBPFIVRe6c+UN1CvUXWvbT4KvMAwzNnnJdCrmg1BKad7/v7y0b5IkiUQiCwGoAx3gQjEugZ0qxTeAIX6MKjMBnBOGS62AVWAPOHVYdlMu9YArYOhphLeBT+ALmOKGEd2QubaAK+B2zngFxt4GgDXgGZjgR8ch5oEkCi8DkvlnRcYLV0Apfqw10M7JvPkV6AN3FmVwK+WyZRnvMEe8ef/ibECyb2o+zRuwnpQAxeLNivQ0BvYyE46qEJ/8fK4ycJKp/X4V4n0MdDNfukkqEO9jwP1LDgD7BeKPgmgp04CL+KUz4Cp+qQxoxC+NAdsNm4c0hWkukkUa8BGfegiadbFDq3/2UAZ8xc+QVvzMtqcKYkBaZ5/MN5xEl2DgLGDZ1KswsC09FPJqXTZoNm5oA6kyMGI2FxqfkluJ0uMTDfhBXAHiHvCCWEL8/RLqlv1MPCf+TSZ+13WC7KnEfWlqcwAeU7GNjnbiQsG5UC1ZAEAt1UMhOpquk6zknMy9l20C2AA+MnEHRo9msuOCs9EH4Fp5TVQ0rqVs0plH4re02Qh1Oq1lCjypsp+5H3gKcD/gykTirqnFZ/ZDy+OGxpapzD+QePrM/2KkKfcGPcv7AdvRkz23G1x4JPIP+AY3r/ywUk/2JAAAAABJRU5ErkJggg==",Hs="/reyohoho/assets/icon-shikimori-DGvXK9Jc.svg",tt=_=>{const l=document.createElement("div");l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.width="100%",l.style.height="100%",l.style.backgroundColor="rgba(0, 0, 0, 0.8)",l.style.color="white",l.style.display="flex",l.style.justifyContent="center",l.style.alignItems="center",l.style.fontSize="2rem",l.style.zIndex="99000",l.textContent=_,document.body.appendChild(l),setTimeout(()=>{document.body.removeChild(l)},2e3)},vn={key:0},pn={key:1},mn={class:"players-list"},fn=["onClick"],gn={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},yn=["onClick"],hn={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},bn=["onClick"],wn={key:0,class:"warning-icon material-icons",title:"–í–Ω–∏–º–∞–Ω–∏–µ!"},kn={__name:"PlayerModal",props:{players:{type:Array,required:!0},selectedPlayer:{type:Object,default:null}},emits:["close","select"],setup(_,{emit:l}){const v=_,c=l,f=p(null),k=le(()=>{const C=[],z=new Set;for(const I of v.players)R(I)?z.has("veoveo")||(C.push({type:"group",name:"veoveo",displayName:"VeoVeo"}),z.add("veoveo")):E(I)?z.has("kodik")||(C.push({type:"group",name:"kodik",displayName:"Kodik"}),z.add("kodik")):C.push({type:"player",data:I});return C}),R=C=>C.name.toUpperCase().includes("VEOVEO"),E=C=>C.name.toUpperCase().includes("KODIK"),d=C=>C.replace(/VEOVEO>/,"").replace(/KODIK>/,"").trim(),H=C=>{c("select",C),c("close")},X=C=>v.selectedPlayer&&v.selectedPlayer.key===C.key,F=C=>v.selectedPlayer?C==="veoveo"&&R(v.selectedPlayer)||C==="kodik"&&E(v.selectedPlayer):!1,ae=C=>{f.value=C},W=()=>{f.value=null},$=C=>{let z=v.players.filter(I=>C==="veoveo"&&R(I)||C==="kodik"&&E(I));return C==="kodik"?z.sort((I,Ce)=>d(I.translate).localeCompare(d(Ce.translate))):z},y=C=>$(C).some(z=>z.warning);return(C,z)=>(w(),S("div",{class:"modal",onClick:z[2]||(z[2]=dt(I=>C.$emit("close"),["self"]))},[n("div",{class:"modal-content",onClick:z[1]||(z[1]=dt(()=>{},["stop"]))},[n("button",{class:"close",onClick:z[0]||(z[0]=I=>C.$emit("close"))},"√ó"),f.value?(w(),S("h2",pn,[n("button",{class:"back-btn",onClick:W},"‚Üê –ù–∞–∑–∞–¥"),Ke(" "+b(f.value),1)])):(w(),S("h2",vn,"–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–µ–µ—Ä")),n("ul",mn,[f.value?(w(!0),S(De,{key:1},ot($(f.value),I=>(w(),S("li",{key:I.key},[n("button",{class:L(["player-item",{active:X(I)}]),onClick:Ce=>H(I)},[Ke(b(d(I.translate))+" ",1),I.warning?(w(),S("span",wn,"warning")):ie("",!0)],10,bn)]))),128)):(w(!0),S(De,{key:0},ot(k.value,I=>(w(),S("li",{key:I.type==="player"?I.data.key:I.name},[I.type==="player"?(w(),S("button",{key:0,class:L(["player-item",{active:X(I.data)}]),onClick:Ce=>H(I.data)},[Ke(b(d(I.data.translate))+" ",1),I.data.warning?(w(),S("span",gn,"warning")):ie("",!0)],10,fn)):(w(),S("button",{key:1,class:L(["group-item",{active:F(I.name)}]),onClick:Ce=>ae(I.name)},[z[3]||(z[3]=n("span",{class:"material-icons group-icon"},"folder",-1)),Ke(" "+b(I.displayName)+" ",1),y(I.name)?(w(),S("span",hn,"warning")):ie("",!0)],10,yn))]))),128))])])]))}},xn=qt(kn,[["__scopeId","data-v-4c8cca9d"]]);class Sn{constructor(){this.ws=null,this.isConnected=!1,this.isAuthenticated=!1,this.messageId=0,this.sources=new Map,this.filtersFound=new Map,this.pendingRequests=new Map,this.callbacks={onConnect:null,onDisconnect:null,onSourcesUpdated:null,onFiltersFound:null,onError:null},this.BLUR_FILTER_NAME="reyohoho"}generateMessageId(){return++this.messageId}setCallbacks(l){this.callbacks=l}async connect(l="localhost",v=4455,c=""){return new Promise((f,k)=>{const R="ws://".concat(l,":").concat(v);console.log("Connecting to OBS WebSocket at ".concat(R)),this.ws=new WebSocket(R),this.ws.onopen=async()=>{var E,d;console.log("WebSocket connection opened");try{const H=await this.authenticate(c);console.log("Authentication response:",H),H.success?(console.log("Successfully authenticated to OBS"),(d=(E=this.callbacks).onConnect)==null||d.call(E),this.loadSourcesAndSearchFilters(),f()):(console.error("Authentication failed"),k(new Error("Authentication failed")))}catch(H){console.error("Error during authentication:",H),k(H)}},this.ws.onmessage=E=>{this.handleMessage(JSON.parse(E.data))},this.ws.onclose=()=>{var E,d;console.log("WebSocket connection closed"),(d=(E=this.callbacks).onDisconnect)==null||d.call(E)},this.ws.onerror=E=>{var d,H;console.error("WebSocket error:",E),(H=(d=this.callbacks).onError)==null||H.call(d,E.message||"Connection error"),k(E)}})}disconnect(){if(this.ws&&(this.ws.close(),this.ws=null),this.pendingRequests){for(const[,{reject:l}]of this.pendingRequests.entries())l(new Error("Connection closed"));this.pendingRequests.clear()}this.sources.clear(),this.filtersFound.clear()}sendRequest(l,v={}){return new Promise((c,f)=>{if(!this.isConnected||!this.ws){console.warn("No connection to OBS"),f(new Error("No connection to OBS"));return}const k=this.generateMessageId().toString(),R={op:6,d:{requestType:l,requestId:k,requestData:v}};console.log("Sending OBS request: ".concat(l),v),this.pendingRequests.set(k,{resolve:c,reject:f}),this.ws.send(JSON.stringify(R)),setTimeout(()=>{this.pendingRequests&&this.pendingRequests.has(k)&&(this.pendingRequests.delete(k),f(new Error("Request ".concat(l," timed out"))))},1e4)})}handleMessage(l){switch(l.op){case 0:this.handleHello(l.d);break;case 2:this.handleIdentified();break;case 7:this.handleRequestResponse(l.d);break;case 5:this.handleEvent(l.d);break;default:console.log("Unknown OBS message: op=".concat(l.op))}}authenticate(l=""){return new Promise(v=>{this.password=l,this.authResolve=v})}async handleHello(l){console.log("Received OBS hello"),this.isConnected=!0;const v={op:1,d:{rpcVersion:1}};if(l.authentication&&this.password)try{const c=new TextEncoder,f=await crypto.subtle.digest("SHA-256",c.encode(this.password+l.authentication.salt)),k=Array.from(new Uint8Array(f)),R=btoa(String.fromCharCode(...k)),E=await crypto.subtle.digest("SHA-256",c.encode(R+l.authentication.challenge)),d=Array.from(new Uint8Array(E)),H=btoa(String.fromCharCode(...d));v.d.authentication=H}catch(c){console.error("Authentication error:",c)}this.ws.send(JSON.stringify(v))}handleIdentified(){console.log("OBS authentication successful"),this.isAuthenticated=!0,this.authResolve&&(this.authResolve({success:!0}),this.authResolve=null)}handleRequestResponse(l){const{requestId:v,requestType:c,requestStatus:f,responseData:k}=l;if(console.log("Received response for ".concat(c,":"),{success:f.result,code:f.code,comment:f.comment}),!this.pendingRequests){console.warn("No pending requests map");return}const R=this.pendingRequests.get(v);if(!R){console.warn("No pending request found for ID: ".concat(v));return}this.pendingRequests.delete(v),f.result?(console.log("Request ".concat(c," successful"),k),R.resolve(k)):(console.error("Request ".concat(c," failed:"),f.comment),R.reject(new Error("".concat(c," failed: ").concat(f.comment))))}handleFilterListResponse(l){const v=l.sourceName,f=(l.filters||[]).find(k=>k.filterName.toLowerCase()===this.BLUR_FILTER_NAME.toLowerCase());f&&(this.foundFilters.set(v,{sourceName:v,filterName:f.filterName,enabled:f.filterEnabled}),console.log("Found reyohoho filter in source: ".concat(v))),this.checkSearchComplete()}checkSearchComplete(){setTimeout(()=>{var l,v;console.log("Search complete. Found ".concat(this.foundFilters.size," reyohoho filters")),(v=(l=this.callbacks).onFiltersFound)==null||v.call(l,Array.from(this.foundFilters.values()))},500)}handleEvent(l){console.log("OBS event: ".concat(l.eventType))}async testConnection(){try{console.log("Testing OBS connection...");const l=await this.sendRequest("GetVersion");return console.log("OBS connection test successful:",l),{success:!0,version:l}}catch(l){return console.error("OBS connection test failed:",l),{success:!1,error:l.message}}}async loadSourcesAndSearchFilters(){var l,v,c,f,k,R,E,d,H,X;try{console.log("Loading sources and searching for filters...");try{const $=await this.sendRequest("GetVersion");console.log("OBS version info:",$)}catch($){console.warn("Could not get OBS version:",$)}console.log("Requesting scene list...");const F=await this.sendRequest("GetSceneList");if(console.log("Raw scenes response:",F),!F||!F.scenes){console.error("Invalid scenes response structure:",F),(v=(l=this.callbacks).onError)==null||v.call(l,"Invalid response from OBS - no scenes data");return}console.log("Found scenes:",F.scenes.length),console.log("Requesting input list...");const ae=await this.sendRequest("GetInputList");if(console.log("Raw inputs response:",ae),!ae||!ae.inputs){console.error("Invalid inputs response structure:",ae),(f=(c=this.callbacks).onError)==null||f.call(c,"Invalid response from OBS - no inputs data");return}console.log("Found inputs:",ae.inputs.length),this.sources.clear(),this.filtersFound.clear();for(const $ of F.scenes)if(console.log("Checking scene: ".concat($.sceneName," with ").concat($.sceneItems?$.sceneItems.length:0," items")),$.sceneItems&&Array.isArray($.sceneItems))for(const y of $.sceneItems)y.sourceName&&(this.sources.set(y.sourceName,{sceneName:$.sceneName,sourceId:y.sceneItemId,sourceName:y.sourceName}),await this.searchFiltersInSource(y.sourceName,$.sceneName));for(const $ of ae.inputs)console.log("Checking input: ".concat($.inputName)),this.sources.has($.inputName)||this.sources.set($.inputName,{sceneName:"Direct Input",sourceId:null,sourceName:$.inputName}),await this.searchFiltersInSource($.inputName,"Direct Input");const W=Array.from(this.filtersFound.values());console.log("Total filters found:",W.length),W.forEach($=>{console.log("- ".concat($.sourceName,": ").concat($.filterName," (").concat($.enabled?"enabled":"disabled",")"))}),(R=(k=this.callbacks).onFiltersFound)==null||R.call(k,W),(d=(E=this.callbacks).onSourcesUpdated)==null||d.call(E,Array.from(this.sources.values()))}catch(F){console.error("Error loading sources:",F),console.error("Error stack:",F.stack),(X=(H=this.callbacks).onError)==null||X.call(H,"Error loading sources: ".concat(F.message))}}async searchFiltersInSource(l,v){try{console.log("Searching filters in source: ".concat(l));const c=await this.sendRequest("GetSourceFilterList",{sourceName:l});console.log("Source ".concat(l," has ").concat(c.filters.length," filters"));for(const f of c.filters){console.log("  Filter: ".concat(f.filterName," (").concat(f.filterEnabled?"enabled":"disabled",")"));const k="".concat(l,"::").concat(f.filterName);this.filtersFound.set(k,{id:k,sourceName:l,sceneName:v,filterName:f.filterName,enabled:f.filterEnabled})}}catch(c){console.warn("Could not get filters for source ".concat(l,":"),c)}}async enableBlur(l){var c,f;if(!l){console.warn("No filter selected for blur");return}const v=this.filtersFound.get(l);if(!v){console.warn("Selected filter not found:",l);return}try{await this.sendRequest("SetSourceFilterEnabled",{sourceName:v.sourceName,filterName:v.filterName,filterEnabled:!0}),v.enabled=!0,console.log("Enabled blur filter: ".concat(v.sourceName,"::").concat(v.filterName))}catch(k){(f=(c=this.callbacks).onError)==null||f.call(c,"Error enabling filter: ".concat(k.message))}}async disableBlur(l){var c,f;if(!l){console.warn("No filter selected for blur");return}const v=this.filtersFound.get(l);if(!v){console.warn("Selected filter not found:",l);return}try{await this.sendRequest("SetSourceFilterEnabled",{sourceName:v.sourceName,filterName:v.filterName,filterEnabled:!1}),v.enabled=!1,console.log("Disabled blur filter: ".concat(v.sourceName,"::").concat(v.filterName))}catch(k){(f=(c=this.callbacks).onError)==null||f.call(c,"Error disabling filter: ".concat(k.message))}}async testBlur(l,v=2e3){if(!l){console.warn("No filter selected for test");return}await this.enableBlur(l),setTimeout(()=>{this.disableBlur(l)},v)}getFilterById(l){return this.filtersFound.get(l)}getAllFilters(){return Array.from(this.filtersFound.values())}}const Cn={class:"players-list"},In={class:"source-modal"},En={key:0,class:"source-loading"},Tn={key:1,class:"source-error"},An={key:2,class:"source-empty"},$n={key:3,class:"source-candidate-list"},Mn=["onClick"],Bn={class:"source-title"},Fn={class:"source-meta"},Pn=["src"],On={key:2,class:"controls"},Nn={class:"main-controls"},Rn={class:"material-icons"},Ln={class:"list-button-item"},_n={class:"material-icons"},Dn={class:"list-button-item"},qn={class:"material-icons"},Hn={class:"list-button-item"},Wn={class:"list-button-item"},zn={class:"material-icons"},Vn={class:"list-button-item"},Un={class:"material-icons"},Kn={class:"tooltip-container","data-tooltip-container":"dimming"},Gn={class:"material-icons"},Yn={class:"tooltip-container","data-tooltip-container":"blur"},jn={class:"tooltip-container","data-tooltip-container":"compressor"},Xn={class:"tooltip-container","data-tooltip-container":"mirror"},Jn={class:"tooltip-container","data-tooltip-container":"theater"},Zn={class:"material-symbols-outlined"},Qn={class:"custom-tooltip","data-tooltip":"theater"},es={class:"tooltip-container","data-tooltip-container":"pip"},ts={class:"tooltip-container","data-tooltip-container":"aspect_ratio"},os={class:"current-ratio"},ns=["onClick"],ss={key:0,class:"tooltip-container","data-tooltip-container":"app_link"},is={class:"custom-tooltip","data-tooltip":"app_link"},ls={key:1,class:"tooltip-container","data-tooltip-container":"copy_link"},as={class:"custom-tooltip","data-tooltip":"copy_link"},rs={key:2,class:"tooltip-container","data-tooltip-container":"overlay"},cs={class:"material-icons"},us={key:0,class:"desktop-list-buttons"},ds={class:"tooltip-container"},vs={class:"material-icons"},ps={class:"custom-tooltip"},ms={class:"tooltip-container"},fs={class:"material-icons"},gs={class:"custom-tooltip"},ys={class:"tooltip-container"},hs={class:"custom-tooltip"},bs={class:"tooltip-container"},ws={class:"material-icons"},ks={class:"custom-tooltip"},xs={class:"tooltip-container"},Ss={class:"material-icons"},Cs={class:"custom-tooltip"},Is={__name:"PlayerComponent",props:{kpId:String,movieInfo:{type:Object,default:()=>({})}},emits:["update:selectedPlayer","update:movieInfo"],setup(_,{emit:l}){const v=ro(),c=cn(),f=Xo(),k=Jo(),R=co(),E=p(k.params.kp_id),d=_,H=l,X=p([]),F=p(null),ae=p(!0),W=p(!1),$=p(!1),y=p(null),C=p(null),z=p(!1),I=p(!1),Ce=p([]),ee=p(!1),Z=p(""),j=p(""),qe=p(null),vt=p(window.innerHeight*.9),po=le(()=>"".concat(vt.value,"px")),pt=le(()=>v.isMobile),x=le(()=>!!window.electronAPI),Ht=le(()=>v.contentApiProvider==="kinobd"&&!String(d.kpId||"").startsWith("shiki")),A=p(null),mt=p(!1);let kt=null;const Ge=p(null),mo=p(null),fo=p(null),fe=p(null),Ye=p(!1),xe=p(!1),ge=p(null),xt=p(null),ft=p(0),ue=p(null),Ee=p(null),Se=p(null),He=p(null),We=p(null),Te=p(null),D=le({get:()=>c.videoOverlayEnabled2,set:t=>c.updateVideoOverlay(t)}),M=le({get:()=>c.overlaySettings,set:t=>c.updateOverlaySettings(t)}),Wt=p(0),zt=p(0),ze=p([]),nt=p(!1);let Pe=null;const m=p(null),je=p(null),Ae=p(!1),J=p(null),$e=p(!1),Vt=p([]),Xe=p([]),ve=le({get:()=>c.obsSettings,set:t=>c.updateObsSettings(t)}),St=t=>{const e=document.querySelector('[data-tooltip-container="'.concat(t,'"]')),o=document.querySelector('[data-tooltip="'.concat(t,'"]'));if(!e||!o)return;const i=e.getBoundingClientRect(),s=o.getBoundingClientRect(),h=window.innerHeight;i.bottom+s.height>h?(o.style.top="auto",o.style.bottom="100%",o.style.marginTop="0",o.style.marginBottom="12px",o.style.transform="translateX(-50%)"):(o.style.top="100%",o.style.bottom="auto",o.style.marginTop="12px",o.style.marginBottom="0",o.style.transform="translateX(-50%)")},re=t=>{A.value=t,mt.value=!1,clearTimeout(kt),_t(()=>{St(t)})},Ct=()=>{mt.value||(kt=setTimeout(()=>{A.value=null},300))},It=()=>{mt.value=!0,clearTimeout(kt)},gt=()=>{mt.value=!1,A.value=null},Oe=le({get:()=>c.aspectRatio,set:t=>c.updateAspectRatio(t)}),st=le({get:()=>c.isCentered,set:t=>c.updateCentering(t)}),go=le(()=>{var t,e,o,i,s,h,U,N,a,g;return((e=(t=d.movieInfo)==null?void 0:t.lists)==null?void 0:e.isFavorite)||((i=(o=d.movieInfo)==null?void 0:o.lists)==null?void 0:i.isWatching)||((h=(s=d.movieInfo)==null?void 0:s.lists)==null?void 0:h.isLater)||((N=(U=d.movieInfo)==null?void 0:U.lists)==null?void 0:N.isCompleted)||((g=(a=d.movieInfo)==null?void 0:a.lists)==null?void 0:g.isAbandoned)}),Ut=le(()=>c.preferredPlayer),yo=p(0),yt=t=>t.toUpperCase(),Kt=t=>{if(X.value=Object.entries(t||{}).map(([e,o])=>({key:e.toUpperCase(),...o})),X.value.length!==0){if(Ut.value){const e=yt(Ut.value),o=X.value.find(i=>yt(i.key)===e);F.value=o||X.value[0]}else F.value=X.value[0];H("update:selectedPlayer",F.value)}},Et=()=>{if(W.value||!C.value)return;const[t,e]=Oe.value.split(":").map(Number);vt.value=window.innerHeight*.9,yo.value=Math.min(C.value.clientWidth*(e/t),vt.value)},ho=le(()=>{if(W.value)return{};const[t,e]=Oe.value.split(":").map(Number),o=vt.value*(t/e);return{width:"100%",maxWidth:"".concat(o,"px"),maxHeight:po.value,margin:"0 auto",overflow:"hidden"}}),bo=le(()=>{const[t,e]=Oe.value.split(":").map(Number);return{position:"relative",width:"100%",paddingTop:"".concat(e/t*100,"%")}}),it=()=>{C.value&&setTimeout(()=>{_t(()=>{C.value.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})},500)},wo=async()=>{var t;try{j.value="",qe.value=null;let e;if(d.kpId.startsWith("shiki")){const o=d.kpId.replace("shiki","");e=await en(o)}else{const o=((t=c.kinobdSourceByKpId)==null?void 0:t[String(d.kpId)])||null;e=await tn(d.kpId,{mode:"kp_id",usePlayerData:!0,forceInid:Ht.value?o:null})}Kt(e)}catch(e){const{message:o,code:i}=so(e);j.value=o,qe.value=i,console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–ª–µ–µ—Ä–æ–≤:",e)}},ko=()=>{z.value=!0},Gt=()=>{z.value=!1},xo=async()=>{var t,e,o,i;I.value=!0,Z.value="",ee.value=!0;try{const s=((t=d.movieInfo)==null?void 0:t.title)||((e=d.movieInfo)==null?void 0:e.name_ru)||((o=d.movieInfo)==null?void 0:o.name_en)||((i=d.movieInfo)==null?void 0:i.name_original)||d.kpId;let h=[];s&&(h=await io(s,{type:"title",page:1})),!h.length&&d.kpId&&(h=await io(d.kpId,{type:"kp_id",page:1})),Ce.value=h}catch(s){Z.value="–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤",console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ KinoBD:",s)}finally{ee.value=!1}},Tt=()=>{I.value=!1},So=async t=>{if(t!=null&&t.id){ee.value=!0,Z.value="";try{const e=await on(t.id,{playerUrl:t.iframe});Kt(e),c.setKinoBdSource(d.kpId,t.id),Tt()}catch(e){Z.value="–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫",console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ KinoBD:",e)}finally{ee.value=!1}}},Co=()=>{try{return ue.value||(ue.value=new(window.AudioContext||window.webkitAudioContext)),Ee.value||(Ee.value=ue.value.createDynamicsCompressor(),Ee.value.threshold.value=-50,Ee.value.knee.value=40,Ee.value.ratio.value=12,Ee.value.attack.value=0,Ee.value.release.value=.25,He.value=ue.value.createGain(),We.value=ue.value.createGain(),He.value.gain.value=0,We.value.gain.value=1,Ee.value.connect(He.value),He.value.connect(ue.value.destination),We.value.connect(ue.value.destination)),!0}catch(t){return console.log("Error initializing audio context:",t),!1}},Io=async t=>{try{if(!ue.value||Te.value===t)return!0;const e=y.value,o=(e==null?void 0:e.src)||"";if(o.includes("videoframe")||o.includes("kinoserial.net")||o.includes("allarknow"))return console.log("Player detected as unsupported for compressor:",o),Te.value=t,Se.value=null,xe.value=!1,x.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —ç—Ç–∏–º –ø–ª–µ–µ—Ä–æ–º"),!1;if(Se.value)try{Se.value.disconnect()}catch(s){}const i=async(s=0)=>{s>0&&await new Promise(h=>setTimeout(h,s));try{return Se.value=ue.value.createMediaElementSource(t),Te.value=t,Se.value.connect(Ee.value),Se.value.connect(We.value),console.log("Video audio setup completed (attempt with ".concat(s,"ms delay)")),!0}catch(h){if(h.name==="InvalidStateError"&&h.message.includes("already connected"))return console.log("MediaElementSource already connected (".concat(s,"ms delay attempt)")),!1;throw h}};return await i(0)||await i(100)||await i(300)||await i(800)?!0:(console.log("Video element has internal audio processing, compressor not available for this player"),Te.value=t,Se.value=null,xe.value=!1,x.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —ç—Ç–∏–º –ø–ª–µ–µ—Ä–æ–º"),!1)}catch(e){return console.log("Error setting up video audio:",e),!1}},At=async t=>{if(y.value)try{const e=y.value,o=e.contentDocument||e.contentWindow.document;if(!o)return;const i=o.querySelectorAll("video");if(i.length===0)return;const s=i[0];if(!Co())return;if(!await Io(s)||!Se.value){console.log("Compressor not available for this player");return}t&&!xe.value?(He.value.gain.setValueAtTime(1,ue.value.currentTime),We.value.gain.setValueAtTime(0,ue.value.currentTime),xe.value=!0,x.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –≤–∫–ª—é—á—ë–Ω"),console.log("Compressor enabled")):!t&&xe.value&&(He.value.gain.setValueAtTime(0,ue.value.currentTime),We.value.gain.setValueAtTime(1,ue.value.currentTime),xe.value=!1,x.value&&window.electronAPI.showToast("–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –æ—Ç–∫–ª—é—á—ë–Ω"),console.log("Compressor disabled"))}catch(e){console.log("Compressor error:",e),x.value&&window.electronAPI.showToast("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞")}},Eo=()=>{if(y.value)try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelectorAll("video");if(o.length>0){const i=o[0];i.style.filter.includes("blur")||(i.style.filter="blur(50px)")}else t.style.filter.includes("blur")||(t.style.filter="blur(50px)")}catch(t){console.log("Error enabling blur:",t)}},To=()=>{if(y.value)try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelectorAll("video");if(o.length>0){const i=o[0];i.style.filter.includes("blur")&&(i.style.filter="")}else t.style.filter.includes("blur")&&(t.style.filter="")}catch(t){console.log("Error disabling blur:",t)}},Ao=()=>{if(x.value)try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelectorAll("video");if(o.length>0){const i=o[0];i.style.filter.includes("blur")?i.style.filter="":i.style.filter="blur(50px)"}else t.style.filter.includes("blur")?t.style.filter="":t.style.filter="blur(50px)"}catch(t){console.log("Error toggling blur:",t)}else tt("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank")},Yt=()=>{x.value?(Ve.value=!Ve.value,At(Ve.value)):(tt("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},jt=()=>{x.value?(Je.value=!Je.value,Mo(Je.value)):(tt("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank"))},ht=()=>{W.value=!W.value,W.value?(window.addEventListener("mousemove",$t),document.addEventListener("keydown",Mt),document.body.classList.add("no-scroll")):(window.removeEventListener("mousemove",$t),document.removeEventListener("keydown",Mt),document.body.classList.remove("no-scroll")),$.value=W.value,_t(()=>{it(),y.value&&y.value.focus()})},Xt=p(null),$t=()=>{Xt.value=setTimeout(()=>{clearTimeout(Xt.value),$.value=!1},4e3),$.value=!0},bt=le(()=>v.dimmingEnabled),$o=()=>{W.value||v.toggleDimming()},Ve=le({get:()=>c.compressorEnabled,set:t=>c.updateCompressor(t)}),Je=le({get:()=>c.mirrorEnabled,set:t=>c.updateMirror(t)}),Mo=t=>{if(y.value)try{const e=y.value,o=e.contentDocument||e.contentWindow.document;if(!o)return;const i=o.querySelectorAll("video");if(i.length>0&&(i.forEach(s=>{t?s.style.transform="scaleX(-1)":s.style.transform="scaleX(1)"}),Ye.value=t,x.value)){const s=t?"–ó–µ—Ä–∫–∞–ª–æ –≤–∫–ª—é—á–µ–Ω–æ":"–ó–µ—Ä–∫–∞–ª–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ";window.electronAPI.showToast(s)}}catch(e){}},Bo=()=>{fe.value&&clearInterval(fe.value),fe.value=setInterval(()=>{if(y.value)try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelectorAll("video");if(o.length>0){const i=o[0],h=i.style.transform==="scaleX(-1)";Je.value&&!h?(i.style.transform="scaleX(-1)",Ye.value=!0):!Je.value&&h&&(i.style.transform="scaleX(1)",Ye.value=!1),Te.value!==i?(Te.value=null,xe.value=!1,Ve.value&&setTimeout(()=>{At(!0)},500)):Ve.value!==xe.value&&Se.value&&(console.log("Compressor state mismatch, reapplying"),At(Ve.value))}}catch(t){}},1e3)},Fo=(t=!1)=>{if(!x.value)return;ge.value&&clearInterval(ge.value);let e=!1,o=[];function i(){var s;if(o=[],window.selectedNudityTimings&&Array.isArray(window.selectedNudityTimings)&&((s=d.movieInfo)!=null&&s.nudity_timings)){for(const h of d.movieInfo.nudity_timings)if(window.selectedNudityTimings.includes(h.id)){const U=lo(h.timing_text);U&&U.length>0&&o.push(...U)}}}i(),ge.value=setInterval(()=>{var s,h,U;if(y.value){i();try{const N=y.value,a=N.contentDocument||N.contentWindow.document;if(!a)return;const g=a.querySelectorAll("video");if(g.length>0){const T=g[0];if(Wt.value=T.currentTime||0,zt.value=T.duration||0,x.value&&D.value&&!m.value&&!Ae.value&&Date.now()-(window.iframeLoadTime||0)>=100)try{Ze(a,T)}catch(Q){console.log("Error creating overlay:",Q),Ae.value=!1}if(x.value&&!D.value&&m.value&&setTimeout(()=>{!D.value&&m.value&&Ne()},100),x.value&&((s=d.movieInfo)!=null&&s.nudity_timings)){const V=T.currentTime,Q=[],pe=[];if(window.overlayNudityTimings&&Array.isArray(window.overlayNudityTimings)&&window.overlayNudityTimings.length>0){for(const K of d.movieInfo.nudity_timings)if(window.overlayNudityTimings.includes(K.id)){const P=lo(K.timing_text);if(P&&P.length>0){const q=[];for(const[de,we]of P){let te="normal";V>=de&&V<=we?(te="active",pe.push(K.id)):de>V&&de-V<=5&&(te="upcoming"),q.push({text:"[".concat(et(de),"-").concat(et(we),"]"),status:te})}Q.push({id:K.id,intervals:q})}}}ze.value=Q,nt.value=pe.length>0||Q.some(K=>K.intervals.some(P=>P.status==="upcoming"))}if(x.value&&m.value&&D.value&&to(),!T.paused){const V=T.currentTime,Q=T.duration,pe=Q>0?V/Q*100:0;if(t&&(console.log("Video position: ".concat(V.toFixed(2),"s / ").concat(Q.toFixed(2),"s (").concat(pe.toFixed(1),"%)")),o.length>0)){const P=o.map(([q,de])=>"".concat(et(q)," - ").concat(et(de))).join(", ");console.log("Active blur intervals: [".concat(P,"]"))}let K=!1;for(const[P,q]of o)if(V>=P&&V<=q){K=!0;break}ve.value.enabled&&$e.value&&ve.value.selectedFilterId?K&&!e?((h=J.value)==null||h.enableBlur(ve.value.selectedFilterId),e=!0,console.log("OBS Blur applied at",V.toFixed(2),"seconds")):!K&&e&&((U=J.value)==null||U.disableBlur(ve.value.selectedFilterId),e=!1,console.log("OBS Blur removed at",V.toFixed(2),"seconds")):K&&!e&&x.value?(Eo(),e=!0,console.log("Blur applied at",V.toFixed(2),"seconds")):!K&&e&&!ve.value.enabled&&(To(),e=!1,console.log("Blur removed at",V.toFixed(2),"seconds"))}}}catch(N){console.log("Error monitoring video position:",N)}}},100)},Po=()=>{ae.value=!1,window.iframeLoadTime=Date.now(),Bo(),Fo(),x.value&&D.value&&!m.value&&setTimeout(()=>{try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(e){const o=e.querySelector("video");o&&Ze(e,o)}}catch(t){console.log("Error creating overlay on iframe load:",t),Ae.value=!1}},100)},Mt=t=>{(t.key==="Escape"&&W.value||t.altKey&&t.keyCode===84)&&ht()},Jt=t=>{Oe.value=t,setTimeout(()=>{st.value&&it()},310)},Oo=()=>{const t="reyohoho://#".concat(E.value);try{window.location.href=t}catch(e){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Å—ã–ª–∫–∏:",e)}},No=()=>{const t=window.location.href;navigator.clipboard.writeText(t).then(()=>{}),Ge.value.showNotification("–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∏–ª—å–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞")};function Zt(t){return t.replace(/KODIK>/,"Kodik - ").replace(/VEOVEO>/,"VeoVeo - ").trim()}const Ro=()=>{try{Se.value&&(Se.value.disconnect(),Se.value=null),ue.value&&(ue.value.close(),ue.value=null),Ee.value=null,He.value=null,We.value=null,Te.value=null,xe.value=!1}catch(t){console.log("Error cleaning up audio context:",t)}},Lo=t=>{var e;if(((e=F.value)==null?void 0:e.key)===t.key){Gt();return}F.value=t,ae.value=!0,Ye.value=!1,xe.value=!1,Te.value=null,m.value&&Ne(),fe.value&&(clearInterval(fe.value),fe.value=null),ge.value&&(clearInterval(ge.value),ge.value=null),t.key.toLowerCase().includes("torrents")||c.updatePreferredPlayer(yt(t.key)),H("update:selectedPlayer",t)};Qe(F,t=>{t&&(ae.value=!0,Ye.value=!1,xe.value=!1,Te.value=null,m.value&&Ne(),fe.value&&(clearInterval(fe.value),fe.value=null),ge.value&&(clearInterval(ge.value),ge.value=null),t.key.toLowerCase().includes("torrents")||c.updatePreferredPlayer(yt(t.key)),H("update:selectedPlayer",t))}),Qe(()=>k.params.kp_id,async t=>{t&&t!==E.value&&(E.value=t,Ye.value=!1,xe.value=!1,Te.value=null,m.value&&Ne(),fe.value&&(clearInterval(fe.value),fe.value=null),ge.value&&(clearInterval(ge.value),ge.value=null),ft.value=0,st.value&&it())},{immediate:!0}),Qe(D,t=>{if(x.value)if(t&&!m.value){const e=()=>{if(y.value)try{const o=y.value,i=o.contentDocument||o.contentWindow.document;if(i){const s=i.querySelector("video");if(s){const h=Date.now()-(window.iframeLoadTime||0);h>=100?Ze(i,s):setTimeout(e,100-h)}}}catch(o){console.log("Error creating overlay via watcher:",o),Ae.value=!1}};e()}else!t&&m.value&&Ne()}),Qe(ze,(t,e)=>{if(!x.value)return;const o=e&&e.length>0,i=t&&t.length>0;!o&&i&&(D.value||(D.value=!0,window.electronAPI&&window.electronAPI.showToast("–û–≤–µ—Ä–ª–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á—ë–Ω - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–π–º–∏–Ω–≥–∏")))},{deep:!0}),Qe(()=>ve.value.enabled,t=>{t&&!$e.value?Ft():!t&&$e.value&&eo()}),Qe(M,(t,e)=>{!x.value||!D.value||(e&&t.showBackground!==e.showBackground?m.value&&(Ne(),setTimeout(()=>{if(y.value&&D.value)try{const o=y.value,i=o.contentDocument||o.contentWindow.document;if(i){const s=i.querySelector("video");s&&Ze(i,s)}}catch(o){console.log("Error recreating overlay:",o)}},100)):m.value&&to())},{deep:!0});const wt=["16:9","12:5","4:3"],_o=()=>{const e=(wt.indexOf(Oe.value)+1)%wt.length;Jt(wt[e])},Do=t=>{var o,i,s,h,U,N,a,g,T,V,Q,pe,K;return(K={[Y.FAVORITE]:((i=(o=d.movieInfo)==null?void 0:o.lists)==null?void 0:i.isFavorite)||!1,[Y.HISTORY]:((h=(s=d.movieInfo)==null?void 0:s.lists)==null?void 0:h.isHistory)||!1,[Y.LATER]:((N=(U=d.movieInfo)==null?void 0:U.lists)==null?void 0:N.isLater)||!1,[Y.COMPLETED]:((g=(a=d.movieInfo)==null?void 0:a.lists)==null?void 0:g.isCompleted)||!1,[Y.ABANDONED]:((V=(T=d.movieInfo)==null?void 0:T.lists)==null?void 0:V.isAbandoned)||!1,[Y.WATCHING]:((pe=(Q=d.movieInfo)==null?void 0:Q.lists)==null?void 0:pe.isWatching)||!1}[t])!=null?K:!1},Ie=async t=>{if(!f.token){Ge.value.showNotification('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:qo});return}try{const e={[Y.FAVORITE]:"–∏–∑–±—Ä–∞–Ω–Ω–æ–µ",[Y.HISTORY]:"–∏—Å—Ç–æ—Ä–∏—é",[Y.LATER]:'—Å–ø–∏—Å–æ–∫ "–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"',[Y.COMPLETED]:'—Å–ø–∏—Å–æ–∫ "–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"',[Y.ABANDONED]:'—Å–ø–∏—Å–æ–∫ "–ë—Ä–æ—à–µ–Ω–æ"',[Y.WATCHING]:'—Å–ø–∏—Å–æ–∫ "–°–º–æ—Ç—Ä—é"'};Do(t)?(await nn(E.value,t),Ge.value.showNotification("–£–¥–∞–ª–µ–Ω–æ –∏–∑ ".concat(e[t]))):(await sn(E.value,t),Ge.value.showNotification("–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ ".concat(e[t])))}catch(e){const{message:o,code:i}=so(e);Ge.value.showNotification("".concat(o," ").concat(i))}H("update:movieInfo")},qo=()=>{R.push("/login")},Bt=le(()=>c.showFavoriteTooltip),Ho=()=>{R.push("/settings"),gt()},Wo=async()=>{if(!x.value){tt("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ReYohoho Desktop"),window.open("https://t.me/ReYohoho/126","_blank");return}if(y.value)try{const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=e.querySelector("video");if(!o)return;document.pictureInPictureElement?await document.exitPictureInPicture():document.pictureInPictureEnabled?await o.requestPictureInPicture():tt('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–∂–∏–º "–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ"')}catch(t){console.error("Error toggling PiP:",t),tt('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º "–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ"')}},zo=()=>{if(D.value=!D.value,!D.value)Ne();else{const t=()=>{if(!m.value&&y.value)try{const e=y.value,o=e.contentDocument||e.contentWindow.document;if(o){const i=o.querySelector("video");if(i){const s=Date.now()-(window.iframeLoadTime||0);s>=100?Ze(o,i):setTimeout(t,100-s)}}}catch(e){console.log("Error creating overlay:",e),Ae.value=!1}};t()}},Qt=()=>{J.value&&J.value.disconnect(),J.value=new Sn,J.value.setCallbacks({onConnect:()=>{$e.value=!0,c.setObsConnected(!0),x.value&&window.electronAPI&&window.electronAPI.showToast("–ü–æ–¥–∫–ª—é—á–µ–Ω –∫ OBS WebSocket")},onDisconnect:()=>{$e.value=!1,c.setObsConnected(!1),Vt.value=[],Xe.value=[]},onSourcesUpdated:t=>{Vt.value=t,window.obsSources=t},onFiltersFound:t=>{Xe.value=t,window.obsFiltersFound=t,c.updateObsSettings({filtersFound:t})},onError:t=>{console.error("OBS WebSocket error:",t),x.value&&window.electronAPI&&window.electronAPI.showToast("–û—à–∏–±–∫–∞ OBS: ".concat(t))}})},Ft=async()=>{J.value||Qt(),await J.value.connect(ve.value.host,ve.value.port,ve.value.password)},eo=()=>{J.value&&J.value.disconnect()},Vo=t=>{J.value&&$e.value&&t?J.value.testBlur(t):x.value&&window.electronAPI&&window.electronAPI.showToast("–§–∏–ª—å—Ç—Ä –Ω–µ –≤—ã–±—Ä–∞–Ω –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ OBS")},Uo=()=>{J.value&&$e.value&&J.value.loadSourcesAndSearchFilters()},Ko=()=>Xe.value,Go=()=>{try{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();const t=y.value;if(t){const e=t.contentDocument||t.contentWindow.document;if(e){e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen();const o=e.querySelector("video");o&&(o.webkitExitFullscreen?o.webkitExitFullscreen():o.exitFullscreen&&o.exitFullscreen())}}}catch(t){console.log("Error exiting fullscreen:",t)}},Yo=()=>{if(!x.value)return;const t=y.value,e=t.contentDocument||t.contentWindow.document;if(!e||e.getElementById("overlay-settings-modal"))return;const o=M.value,i=e.createElement("div");i.id="overlay-settings-modal",i.style.cssText="\n    position: fixed !important;\n    top: 0 !important;\n    left: 0 !important;\n    width: 100% !important;\n    height: 100% !important;\n    background: rgba(0, 0, 0, 0.8) !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    z-index: 9999 !important;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n  ";const s=e.createElement("div");s.style.cssText="\n    background: rgba(30, 30, 30, 0.95) !important;\n    backdrop-filter: blur(20px) !important;\n    border-radius: 16px !important;\n    padding: 32px !important;\n    max-width: 400px !important;\n    width: 90% !important;\n    border: 1px solid rgba(255, 255, 255, 0.1) !important;\n    box-shadow: 0 8px 40px rgba(0, 0, 0, 0.5) !important;\n  ",s.innerHTML='\n    <h3 style="color: #ff6b35; margin: 0 0 24px 0; font-size: 20px; font-weight: 600; text-align: center;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–≤–µ—Ä–ª–µ—è</h3>\n    \n    <div style="display: flex; flex-direction: column; gap: 16px;">\n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showTitle" '.concat(o.showTitle?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showDuration" ').concat(o.showDuration2?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showBackground" ').concat(o.showBackground?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω—ã–π —Ñ–æ–Ω</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="showTimingsOnMouseMove" ').concat(o.showTimingsOnMouseMove?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∞–π–º–∏–Ω–≥–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –º—ã—à–∫–∏</span>\n      </label>\n      \n      <label style="display: flex; align-items: center; gap: 12px; color: white; cursor: pointer; padding: 8px; border-radius: 8px; background: rgba(255, 255, 255, 0.05);">\n        <input type="checkbox" id="highlightTimings" ').concat(o.highlightTimings?"checked":"",' style="width: 18px; height: 18px; accent-color: #ff6b35;">\n        <span style="font-size: 16px;">–ü–æ–¥—Å–≤–µ—á–∏–≤–∞—Ç—å –±–ª–∏–∑–∫–∏–µ –∏ —Ç–µ–∫—É—â–∏–µ —Ç–∞–π–º–∏–Ω–≥–∏</span>\n      </label>\n\n    </div>\n    \n    <div style="display: flex; gap: 12px; margin-top: 24px; justify-content: center;">\n      <button id="saveSettings" style="background: #ff6b35; color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.3s ease;">\n        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å\n      </button>\n      <button id="cancelSettings" style="background: rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.8); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; padding: 10px 16px; cursor: pointer; font-size: 14px; transition: all 0.3s ease;">\n        –û—Ç–º–µ–Ω–∞\n      </button>\n    </div>\n  '),["click","mousedown","mouseup","mousemove","wheel","contextmenu"].forEach(a=>{s.addEventListener(a,g=>{g.stopPropagation(),g.stopImmediatePropagation()})}),i.appendChild(s),i.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),a.target===i&&i.remove()}),["mousedown","mouseup","mousemove","wheel","contextmenu"].forEach(a=>{i.addEventListener(a,g=>{g.preventDefault(),g.stopPropagation(),g.stopImmediatePropagation()})}),s.querySelector("#saveSettings").addEventListener("click",a=>{var T;a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation();const g={showTitle:s.querySelector("#showTitle").checked,showDuration2:s.querySelector("#showDuration").checked,showBackground:s.querySelector("#showBackground").checked,showTimingsOnMouseMove:s.querySelector("#showTimingsOnMouseMove").checked,highlightTimings:s.querySelector("#highlightTimings").checked};M.value=g,(T=window.electronAPI)==null||T.showToast("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–≤–µ—Ä–ª–µ—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã"),i.remove()}),s.querySelector("#cancelSettings").addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),i.remove()}),s.querySelectorAll("button").forEach(a=>{a.addEventListener("mouseenter",g=>{g.preventDefault(),g.stopPropagation(),g.stopImmediatePropagation(),a.id==="saveSettings"?(a.style.background="#e55a2b",a.style.transform="translateY(-1px)"):a.style.background="rgba(255, 255, 255, 0.15)"}),a.addEventListener("mouseleave",g=>{g.preventDefault(),g.stopPropagation(),g.stopImmediatePropagation(),a.id==="saveSettings"?(a.style.background="#ff6b35",a.style.transform="translateY(0)"):a.style.background="rgba(255, 255, 255, 0.1)"}),["mousedown","mouseup","mousemove","wheel","contextmenu"].forEach(g=>{a.addEventListener(g,T=>{T.preventDefault(),T.stopPropagation(),T.stopImmediatePropagation()})})});const U=s.querySelectorAll('input[type="checkbox"]'),N=s.querySelectorAll("label");U.forEach(a=>{["click","mousedown","mouseup","mousemove","wheel","contextmenu"].forEach(g=>{a.addEventListener(g,T=>{g!=="click"?(T.preventDefault(),T.stopPropagation(),T.stopImmediatePropagation()):T.stopPropagation()})})}),N.forEach(a=>{["mousedown","mouseup","mousemove","wheel","contextmenu"].forEach(g=>{a.addEventListener(g,T=>{T.preventDefault(),T.stopPropagation(),T.stopImmediatePropagation()})})}),e.body.appendChild(i)},Ze=(t,e)=>{if(!D.value||m.value||Ae.value)return;Ae.value=!0;const o=t.createElement("div");o.id="reyohoho-video-overlay";let i=()=>{o.style.cssText="\n      position: absolute !important;\n      top: 0 !important;\n      left: 0 !important;\n      width: 100% !important;\n      height: 100% !important;\n      pointer-events: none !important;\n      z-index: 999999999 !important;\n      display: flex !important;\n      flex-direction: column !important;\n      justify-content: space-between !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      visibility: visible !important;\n      opacity: 1 !important;\n    "};const s=t.createElement("div");s.style.cssText="\n    color: white !important;\n    padding: 20px !important;\n    text-align: left !important;\n    pointer-events: none !important;\n  ";const h=t.createElement("div"),U=M.value.showBackground?"rgba(0, 0, 0, 0.7)":"transparent",N=M.value.showBackground?"blur(10px)":"none",a=M.value.showBackground?"fit-content":"auto",g=M.value.fontSize||18;h.style.cssText="\n    font-size: ".concat(g+2,"px !important;\n    font-weight: 600 !important;\n    margin-bottom: 8px !important;\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8) !important;\n    line-height: 1.2 !important;\n    padding: 8px 12px !important;\n    border-radius: 6px !important;\n    display: inline-block !important;\n    color: rgba(255, 255, 255, 0.6) !important;\n    background: ").concat(U," !important;\n    backdrop-filter: ").concat(N," !important;\n    width: ").concat(a," !important;\n  ");const T=t.createElement("div"),V=M.value.showBackground?"rgba(0, 0, 0, 0.7)":"transparent",Q=M.value.showBackground?"blur(10px)":"none",pe=M.value.showBackground?"6px":"0",K=M.value.showBackground?"inline-flex":"flex",P=M.value.showBackground?"fit-content":"auto";T.style.cssText="\n    font-size: ".concat(g,"px !important;\n    font-weight: 500 !important;\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8) !important;\n    display: ").concat(K," !important;\n    align-items: center !important;\n    gap: 8px !important;\n    flex-wrap: wrap !important;\n    color: rgba(255, 255, 255, 0.6) !important;\n    margin-left: 12px !important;\n    background: ").concat(V," !important;\n    backdrop-filter: ").concat(Q," !important;\n    border-radius: ").concat(pe," !important;\n    width: ").concat(P," !important;\n  ");const q=t.createElement("div"),de=M.value.showBackground?"rgba(0, 0, 0, 0.7)":"transparent",we=M.value.showBackground?"blur(10px)":"none";q.style.cssText="\n    position: absolute !important;\n    top: 20px !important;\n    right: 110px !important;\n    background: ".concat(de," !important;\n    backdrop-filter: ").concat(we," !important;\n    border-radius: 12px !important;\n    padding: 16px !important;\n    width: fit-content !important;\n    max-width: 800px !important;\n    pointer-events: none !important;\n    display: none !important;\n    transition: opacity 0.3s ease, visibility 0.3s ease !important;\n    opacity: 0 !important;\n    visibility: hidden !important;\n  ");const te=t.createElement("div");te.style.cssText="\n    font-size: ".concat(g-4,"px !important;\n    color: rgba(255, 255, 255, 0.6) !important;\n    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8) !important;\n    line-height: 1.4 !important;\n    word-wrap: break-word !important;\n  ");const G=t.createElement("div");G.style.cssText="\n    position: absolute !important;\n    top: 20px !important;\n    right: 20px !important;\n    display: flex !important;\n    gap: 8px !important;\n    pointer-events: all !important;\n  ";const ce=t.createElement("button");ce.style.cssText="\n    background: rgba(0, 0, 0, 0.8) !important;\n    backdrop-filter: blur(10px) !important;\n    color: white !important;\n    border: 1px solid rgba(255, 255, 255, 0.2) !important;\n    border-radius: 50% !important;\n    width: 40px !important;\n    height: 40px !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    font-size: 18px !important;\n  ",ce.innerHTML="‚öôÔ∏è",ce.title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–≤–µ—Ä–ª–µ—è";const ke=t.createElement("button");ke.style.cssText="\n    background: rgba(0, 0, 0, 0.8) !important;\n    backdrop-filter: blur(10px) !important;\n    color: white !important;\n    border: 1px solid rgba(255, 255, 255, 0.2) !important;\n    border-radius: 50% !important;\n    width: 40px !important;\n    height: 40px !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    font-size: 20px !important;\n    font-weight: bold !important;\n  ",ke.innerHTML="A-",ke.title="–£–º–µ–Ω—å—à–∏—Ç—å —à—Ä–∏—Ñ—Ç";const Be=t.createElement("button");Be.style.cssText="\n    background: rgba(0, 0, 0, 0.8) !important;\n    backdrop-filter: blur(10px) !important;\n    color: white !important;\n    border: 1px solid rgba(255, 255, 255, 0.2) !important;\n    border-radius: 50% !important;\n    width: 40px !important;\n    height: 40px !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    font-size: 20px !important;\n    font-weight: bold !important;\n  ",Be.innerHTML="A+",Be.title="–£–≤–µ–ª–∏—á–∏—Ç—å —à—Ä–∏—Ñ—Ç";const Fe=t.createElement("button");Fe.style.cssText="\n    background: rgba(0, 0, 0, 0.8) !important;\n    backdrop-filter: blur(10px) !important;\n    color: white !important;\n    border: 1px solid rgba(255, 255, 255, 0.2) !important;\n    border-radius: 50% !important;\n    width: 40px !important;\n    height: 40px !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    cursor: pointer !important;\n    transition: all 0.3s ease !important;\n    font-size: 18px !important;\n  ",Fe.innerHTML="üëÅÔ∏è",Fe.title="–û—Ç–∫–ª—é—á–∏—Ç—å –æ–≤–µ—Ä–ª–µ–π",Fe.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),u.stopImmediatePropagation(),D.value=!1}),ce.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),u.stopImmediatePropagation(),Go(),setTimeout(()=>{Yo()},100)}),ke.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),u.stopImmediatePropagation();const B=M.value.fontSize||18;B>10&&(M.value={...M.value,fontSize:B-2})}),Be.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),u.stopImmediatePropagation();const B=M.value.fontSize||18;B<36&&(M.value={...M.value,fontSize:B+2})}),[ce,Fe,ke,Be].forEach(u=>{u.addEventListener("mouseenter",B=>{B.preventDefault(),B.stopPropagation(),B.stopImmediatePropagation(),u.style.background="#ff6b35",u.style.borderColor="#ff6b35",u.style.transform="scale(1.1)"}),u.addEventListener("mouseleave",B=>{B.preventDefault(),B.stopPropagation(),B.stopImmediatePropagation(),u.style.background="rgba(0, 0, 0, 0.8)",u.style.borderColor="rgba(255, 255, 255, 0.2)",u.style.transform="scale(1)"}),["mousedown","mouseup","mousemove","wheel","contextmenu"].forEach(B=>{u.addEventListener(B,O=>{O.preventDefault(),O.stopPropagation(),O.stopImmediatePropagation()})})}),["click","mousedown","mouseup","mousemove","wheel","contextmenu"].forEach(u=>{G.addEventListener(u,B=>{B.preventDefault(),B.stopPropagation(),B.stopImmediatePropagation()})}),G.appendChild(ke),G.appendChild(Be),G.appendChild(ce),G.appendChild(Fe),q.appendChild(te),s.appendChild(h),s.appendChild(T),o.appendChild(s),o.appendChild(q),o.appendChild(G),G.style.transition="opacity 0.3s ease, visibility 0.3s ease",G.style.opacity="0",G.style.visibility="hidden",s.style.transition="opacity 0.3s ease";let Ue=null;const lt=()=>{G.style.opacity="1",G.style.visibility="visible",s.style.opacity="0",M.value.showTimingsOnMouseMove&&ze.value.length>0&&(q.style.opacity="1",q.style.visibility="visible",clearTimeout(Pe),Pe=null,nt.value||(Pe=setTimeout(()=>{q.style.opacity="0",q.style.visibility="hidden",Pe=null},3e3))),clearTimeout(je.value),clearTimeout(Ue),je.value=setTimeout(()=>{G.style.opacity="0",G.style.visibility="hidden"},3e3),Ue=setTimeout(()=>{s.style.opacity="1"},2e3)};t.addEventListener("mousemove",lt),o.addEventListener("mouseenter",()=>{G.style.opacity="1",G.style.visibility="visible",s.style.opacity="0",clearTimeout(Ue)}),o.addEventListener("mouseleave",()=>{clearTimeout(je.value),clearTimeout(Ue),G.style.opacity="0",G.style.visibility="hidden",s.style.opacity="1"}),o._mouseHandler=lt;const Re=(u=>{if(document.fullscreenElement===u||document.webkitFullscreenElement===u||u.webkitDisplayingFullscreen||u.offsetWidth===window.screen.width&&u.offsetHeight===window.screen.height)return t.body||t.documentElement;let O=u.parentNode,ye=0;const Me=5;for(;O&&ye<Me;){const me=t.defaultView.getComputedStyle(O),oe=O.getBoundingClientRect();if(oe.width>0&&oe.height>0&&(me.position==="relative"||me.position==="absolute"||me.position==="fixed"||O.tagName==="BODY"))return O;O=O.parentNode,ye++}return u.parentNode})(e);o._targetContainer=Re,o._videoElement=e,i=()=>{const u=o._videoElement,B=o._targetContainer;if(document.fullscreenElement===u||document.webkitFullscreenElement===u||u.webkitDisplayingFullscreen||u.offsetWidth===window.screen.width&&u.offsetHeight===window.screen.height)o.style.cssText="\n        position: fixed !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100vw !important;\n        height: 100vh !important;\n        pointer-events: none !important;\n        z-index: 999999999 !important;\n        display: flex !important;\n        flex-direction: column !important;\n        justify-content: space-between !important;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n        visibility: visible !important;\n        opacity: 1 !important;\n        box-sizing: border-box !important;\n      ";else{const ye=t.defaultView.getComputedStyle(u),Me=B.getBoundingClientRect(),me=u.offsetWidth||u.clientWidth||parseFloat(ye.width)||0,oe=u.offsetHeight||u.clientHeight||parseFloat(ye.height)||0,_e=u.getBoundingClientRect(),he=_e.top-Me.top+B.scrollTop,r=_e.left-Me.left+B.scrollLeft;o.style.cssText="\n        position: absolute !important;\n        top: ".concat(he,"px !important;\n        left: ").concat(r,"px !important;\n        width: ").concat(me,"px !important;\n        height: ").concat(oe,"px !important;\n        pointer-events: none !important;\n        z-index: 999999999 !important;\n        display: flex !important;\n        flex-direction: column !important;\n        justify-content: space-between !important;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n        visibility: visible !important;\n        opacity: 1 !important;\n        box-sizing: border-box !important;\n      ")}},e.style.position="relative",(Re.style.position===""||Re.style.position==="static")&&(Re.style.position="relative"),Re.appendChild(o),i(),m.value=o,Ae.value=!1;const at=setInterval(()=>{if(!m.value||!D.value){clearInterval(at);return}if(!t.body.contains(o))try{const O=t.querySelectorAll("video");if(O.length>0){const ye=O[0];o._videoElement=ye;const me=(oe=>{if(document.fullscreenElement===oe||document.webkitFullscreenElement===oe||oe.webkitDisplayingFullscreen||oe.offsetWidth===window.screen.width&&oe.offsetHeight===window.screen.height)return t.body||t.documentElement;let he=oe.parentNode,r=0;const Nt=5;for(;he&&r<Nt;){const Rt=t.defaultView.getComputedStyle(he),oo=he.getBoundingClientRect();if(oo.width>0&&oo.height>0&&(Rt.position==="relative"||Rt.position==="absolute"||Rt.position==="fixed"||he.tagName==="BODY"))return he;he=he.parentNode,r++}return oe.parentNode})(ye);o._targetContainer=me,me.appendChild(o),i(),o._mouseHandler&&(t.removeEventListener("mousemove",o._mouseHandler),t.addEventListener("mousemove",o._mouseHandler))}}catch(O){console.log("Error re-adding overlay to DOM:",O)}const u=t.defaultView.getComputedStyle(o);if((u.visibility==="hidden"||u.display==="none"||u.opacity==="0")&&i(),(parseInt(u.zIndex)||0)<999999999&&i(),o._videoElement&&o._targetContainer){const O=o._videoElement,ye=t.defaultView.getComputedStyle(O),Me=document.fullscreenElement===O||document.webkitFullscreenElement===O||O.webkitDisplayingFullscreen||O.offsetWidth===window.screen.width&&O.offsetHeight===window.screen.height;let me,oe;Me?(me=window.innerWidth,oe=window.innerHeight):(me=O.offsetWidth||O.clientWidth||parseFloat(ye.width)||0,oe=O.offsetHeight||O.clientHeight||parseFloat(ye.height)||0);const _e=parseInt(u.width)||0,he=parseInt(u.height)||0;(Math.abs(_e-me)>5||Math.abs(he-oe)>5)&&i()}},1e3),rt=new window.MutationObserver(u=>{u.forEach(B=>{B.type==="attributes"&&B.target===o&&B.attributeName==="style"&&setTimeout(()=>{m.value&&D.value&&i()},100)})});rt.observe(o,{attributes:!0,attributeFilter:["style","class"]});const ct=()=>{m.value&&D.value&&i()},Le=()=>{m.value&&D.value&&setTimeout(()=>{i()},100)};t.defaultView.addEventListener("resize",ct),t.addEventListener("fullscreenchange",Le),t.addEventListener("webkitfullscreenchange",Le),e.addEventListener("webkitbeginfullscreen",Le),e.addEventListener("webkitendfullscreen",Le),o._monitorInterval=at,o._mutationObserver=rt,o._resizeHandler=ct,o._fullscreenHandler=Le,o._iframeDoc=t;const ut=setInterval(()=>{if(!m.value||!D.value){clearInterval(ut);return}i()},500);setTimeout(()=>{clearInterval(ut)},1e4)},to=()=>{var T,V,Q,pe,K;if(!m.value||!D.value)return;const t=y.value;if(!t)return;const e=t.contentDocument||t.contentWindow.document;if(!e)return;const o=m.value,i=o.children[0],s=o.children[1],h=e.defaultView.getComputedStyle(o);(h.display==="none"||h.visibility==="hidden")&&(o.style.display="flex !important",o.style.visibility="visible !important");const U=M.value.fontSize||18,N=i.children[0];if(N.style.fontSize="".concat(U+2,"px"),M.value.showTitle){N.style.display="block";const P=((T=d.movieInfo)==null?void 0:T.title)||((V=d.movieInfo)==null?void 0:V.name_ru)||((Q=d.movieInfo)==null?void 0:Q.name_en)||((pe=d.movieInfo)==null?void 0:pe.name_original)||"–ó–∞–≥—Ä—É–∑–∫–∞...",q=(K=d.movieInfo)!=null&&K.year?" (".concat(d.movieInfo.year,")"):"";N.textContent=P+q,M.value.showBackground?(N.style.background="rgba(0, 0, 0, 0.7) !important",N.style.backdropFilter="blur(10px) !important",N.style.width="fit-content !important",N.style.display="inline-block !important"):(N.style.background="transparent !important",N.style.backdropFilter="none !important",N.style.width="auto !important",N.style.display="inline-block !important")}else N.style.display="none";const a=i.children[1];a.style.fontSize="".concat(U,"px");let g="";if(M.value.showDuration2){const P=et(Wt.value),q=et(zt.value);g="\n      <span style=\"font-family: 'Courier New', monospace; color: rgba(255, 255, 255, 0.6);\">".concat(P,'</span>\n      <span style="opacity: 0.6;">/</span>\n      <span style="font-family: \'Courier New\', monospace; color: rgba(255, 255, 255, 0.6);">').concat(q,"</span>\n    ")}if(ve.value.enabled&&ve.value.showObsInOverlay){let P="–û—Ç–∫–ª—é—á–µ–Ω";const q="#999999";if($e.value)if(ve.value.selectedFilterId){const we=Xe.value.find(te=>te.id===ve.value.selectedFilterId);we?P="".concat(we.filterName," (").concat(we.sceneName,")"):P="–§–∏–ª—å—Ç—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"}else Xe.value.length>0?P="–§–∏–ª—å—Ç—Ä –Ω–µ –≤—ã–±—Ä–∞–Ω":P="–§–∏–ª—å—Ç—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã";const de='\n      <span style="color: '.concat(q,';">\n        OBS: ').concat(P,"\n      </span>\n    ");g=g?"".concat(g," ").concat(de):de}if(g?(a.style.display="flex",a.innerHTML=g,M.value.showBackground?(a.style.background="rgba(0, 0, 0, 0.7) !important",a.style.backdropFilter="blur(10px) !important",a.style.borderRadius="6px !important",a.style.padding="8px 12px !important",a.style.width="fit-content !important",a.style.display="inline-flex !important"):(a.style.background="transparent !important",a.style.backdropFilter="none !important",a.style.borderRadius="0 !important",a.style.padding="0 !important",a.style.width="auto !important",a.style.display="flex !important")):a.style.display="none",ze.value.length>0){const P=s.children[0];P.style.fontSize="".concat(U-4,"px"),P.innerHTML="";const q=e.createElement("span");q.textContent="–¢–∞–π–º–∏–Ω–≥–∏: ",q.style.color="rgba(255, 255, 255, 0.6)",P.appendChild(q),ze.value.forEach((de,we)=>{if(we>0){const te=e.createElement("span");te.textContent=", ",te.style.color="rgba(255, 255, 255, 0.6)",P.appendChild(te)}de.intervals.forEach((te,G)=>{if(G>0){const ke=e.createElement("span");ke.textContent=", ",ke.style.color="rgba(255, 255, 255, 0.6)",P.appendChild(ke)}const ce=e.createElement("span");ce.textContent=te.text,te.status==="active"&&M.value.highlightTimings?(ce.style.color="#ff4444",ce.style.fontWeight="bold"):te.status==="upcoming"&&M.value.highlightTimings?(ce.style.color="#ff6b35",ce.style.fontWeight="500"):ce.style.color="rgba(255, 255, 255, 0.6)",P.appendChild(ce)})}),s.style.display="block",(!M.value.showTimingsOnMouseMove||nt.value)&&(s.style.opacity="1",s.style.visibility="visible"),M.value.showBackground?(s.style.background="rgba(0, 0, 0, 0.7) !important",s.style.backdropFilter="blur(10px) !important",s.style.width="fit-content !important",s.style.minWidth="auto !important"):(s.style.background="transparent !important",s.style.backdropFilter="none !important",s.style.width="fit-content !important",s.style.minWidth="auto !important")}else s.style.display="none";M.value.showTimingsOnMouseMove&&nt.value&&ze.value.length>0?(s.style.opacity="1",s.style.visibility="visible",clearTimeout(Pe)):M.value.showTimingsOnMouseMove&&!nt.value&&ze.value.length>0&&s.style.opacity==="1"&&!Pe&&(Pe=setTimeout(()=>{s.style.opacity="0",s.style.visibility="hidden",Pe=null},3e3))},Ne=()=>{if(m.value){try{m.value._monitorInterval&&clearInterval(m.value._monitorInterval),m.value._mutationObserver&&m.value._mutationObserver.disconnect(),m.value._resizeHandler&&m.value._iframeDoc&&m.value._iframeDoc.defaultView.removeEventListener("resize",m.value._resizeHandler),m.value._fullscreenHandler&&m.value._iframeDoc&&(m.value._iframeDoc.removeEventListener("fullscreenchange",m.value._fullscreenHandler),m.value._iframeDoc.removeEventListener("webkitfullscreenchange",m.value._fullscreenHandler),m.value._videoElement&&(m.value._videoElement.removeEventListener("webkitbeginfullscreen",m.value._fullscreenHandler),m.value._videoElement.removeEventListener("webkitendfullscreen",m.value._fullscreenHandler))),m.value._mouseHandler&&m.value._iframeDoc&&m.value._iframeDoc.removeEventListener("mousemove",m.value._mouseHandler),m.value.remove()}catch(t){console.log("Error removing overlay:",t)}m.value=null}Ae.value=!1,je.value&&(clearTimeout(je.value),je.value=null)};uo(()=>{if(ae.value=!0,wo(),pt.value&&(Oe.value="4:3"),Et(),window.addEventListener("resize",Et),window.addEventListener("resize",St),st.value&&it(),window.toggleCompressor=Yt,window.toggleMirror=jt,Qt(),window.connectToOBS=Ft,window.testOBSBlur=Vo,window.refreshOBSFilters=Uo,window.getOBSFiltersInfo=Ko,window.testOBSConnection=jo,window.debugOBS=()=>{var t;console.log("=== OBS Debug Info ==="),console.log("OBS Settings:",ve.value),console.log("OBS Connected:",$e.value),console.log("OBS Filters Found:",Xe.value),console.log("OBS WebSocket instance:",J.value),J.value&&(console.log("WebSocket state:",(t=J.value.ws)==null?void 0:t.readyState),console.log("Is Connected:",J.value.isConnected),console.log("Is Authenticated:",J.value.isAuthenticated))},ve.value.enabled&&Ft(),x.value&&(xt.value=setInterval(()=>{const t=window.overlayNudityTimings?window.overlayNudityTimings.length:0;t>ft.value?(ft.value=t,D.value||(D.value=!0,window.electronAPI&&window.electronAPI.showToast("–û–≤–µ—Ä–ª–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á—ë–Ω - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–π–º–∏–Ω–≥–∏"))):ft.value=t},1e3)),x.value&&D.value){const t=()=>{if(y.value&&!m.value)try{const e=y.value,o=e.contentDocument||e.contentWindow.document;if(o){const i=o.querySelector("video");if(i){const s=Date.now()-(window.iframeLoadTime||0);s>=100?Ze(o,i):setTimeout(t,100-s)}}}catch(e){console.log("Error initializing overlay on mount:",e),Ae.value=!1}};setTimeout(t,1e3)}}),Zo(()=>{window.removeEventListener("resize",Et),window.removeEventListener("resize",St),window.removeEventListener("mousemove",$t),document.removeEventListener("keydown",Mt),document.body.classList.remove("no-scroll"),fe.value&&clearInterval(fe.value),ge.value&&clearInterval(ge.value),xt.value&&clearInterval(xt.value),Ne(),Ro(),eo(),delete window.toggleCompressor,delete window.toggleMirror,delete window.connectToOBS,delete window.testOBSBlur,delete window.refreshOBSFilters,delete window.getOBSFiltersInfo,delete window.testOBSConnection,delete window.debugOBS,delete window.obsSources,delete window.obsFiltersFound});const jo=async()=>J.value&&$e.value?await J.value.testConnection():{success:!1,error:"Not connected"};return(t,e)=>{var o,i,s,h,U,N,a,g,T,V,Q,pe,K,P,q,de,we,te,G,ce,ke,Be,Fe,Ue,lt,Pt,Re,Ot,at,rt,ct,Le,ut,u,B,O,ye,Me,me,oe,_e,he;return j.value?(w(),Lt(Qo,{key:0,message:j.value,code:qe.value},null,8,["message","code"])):(w(),S(De,{key:1},[n("div",Cn,[e[43]||(e[43]=n("span",null,"–ü–ª–µ–µ—Ä:",-1)),n("button",{class:"player-btn",onClick:ko},b(F.value?Zt(F.value.translate).toUpperCase():"–ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–µ–µ—Ä–æ–≤..."),1),Ht.value?(w(),S("button",{key:0,class:"source-btn",onClick:xo},"–ò—Å—Ç–æ—á–Ω–∏–∫")):ie("",!0)]),z.value?(w(),Lt(xn,{key:0,players:X.value,"selected-player":F.value,onClose:Gt,onSelect:Lo},null,8,["players","selected-player"])):ie("",!0),I.value?(w(),S("div",{key:1,class:"source-modal-backdrop",onClick:dt(Tt,["self"])},[n("div",In,[n("div",{class:"source-modal-header"},[e[44]||(e[44]=n("h3",null,"–í—ã–±–æ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞ KinoBD",-1)),n("button",{class:"source-close-btn",onClick:Tt},"√ó")]),ee.value?(w(),S("div",En,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤...")):Z.value?(w(),S("div",Tn,b(Z.value),1)):Ce.value.length===0?(w(),S("div",An,"–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")):(w(),S("ul",$n,[(w(!0),S(De,null,ot(Ce.value,r=>(w(),S("li",{key:r.id},[n("button",{class:"source-candidate-btn",onClick:Nt=>So(r)},[n("span",Bn,b(r.title||"ID ".concat(r.id)),1),n("span",Fn,"inid: "+b(r.id)+" ¬∑ kp: "+b(r.kp_id||"-"),1)],8,Mn)]))),128))]))])])):ie("",!0),n("div",{ref_key:"containerRef",ref:C,class:L(["player-container",{"theater-mode":W.value}]),style:no(W.value?{}:ho.value)},[n("div",{class:"iframe-wrapper",style:no(W.value?{}:bo.value)},[ne(n("iframe",{ref_key:"playerIframe",ref:y,src:(o=F.value)==null?void 0:o.iframe,frameborder:"0",allowfullscreen:"",webkitallowfullscreen:"",class:L(["responsive-iframe",{"theater-mode-unlock":$.value,"theater-mode-lock":W.value,dimmed:bt.value}]),onLoad:Po},null,42,Pn),[[se,!ae.value&&((i=F.value)==null?void 0:i.iframe)]]),ae.value?(w(),Lt(rn,{key:0,text:"–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–ª–µ–µ—Ä: ".concat(F.value?Zt(F.value.translate):"–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –ø–ª–µ–µ—Ä–æ–≤","\n–ï—Å–ª–∏ –ø–ª–µ–µ—Ä –Ω–µ –≥—Ä—É–∑–∏—Ç—Å—è, —Ç–æ —Å–º–µ–Ω–∏—Ç–µ –ø–ª–µ–µ—Ä –≤—ã—à–µ –∏–ª–∏ –≤–∫–ª—é—á–∏—Ç–µ VPN"),style:{"white-space":"pre-line"}},null,8,["text"])):ie("",!0)],4),W.value?(w(),S("button",{key:0,class:L(["close-theater-btn",{visible:$.value}]),onClick:ht}," ‚úñ ",2)):ie("",!0)],6),W.value?ie("",!0):(w(),S("div",On,[n("div",Nn,[!pt.value&&E.value?(w(),S("div",{key:0,ref_key:"tooltipContainer",ref:mo,class:"tooltip-container list-buttons-container","data-tooltip-container":"favorite"},[Bt.value?(w(),S("button",{key:0,class:L(["favorite-btn",{active:(h=(s=_.movieInfo)==null?void 0:s.lists)==null?void 0:h.isFavorite}]),onMouseenter:e[0]||(e[0]=r=>re("favorite")),onMouseleave:Ct,onClick:e[1]||(e[1]=r=>Ie(be(Y).FAVORITE))},[n("span",Rn,b((N=(U=_.movieInfo)==null?void 0:U.lists)!=null&&N.isFavorite?"favorite":"favorite_border"),1),n("span",{class:L(["material-icons dropdown-arrow",{highlighted:go.value}])},"expand_more",2)],34)):ie("",!0),ne(n("div",{ref_key:"tooltip",ref:fo,class:"custom-tooltip advanced-tooltip list-buttons-dropdown","data-tooltip":"favorite",onMouseenter:It,onMouseleave:gt},[n("div",Ln,[n("button",{class:L(["favorite-btn",{active:(g=(a=_.movieInfo)==null?void 0:a.lists)==null?void 0:g.isFavorite}]),onClick:e[2]||(e[2]=r=>Ie(be(Y).FAVORITE))},[n("span",_n,b((V=(T=_.movieInfo)==null?void 0:T.lists)!=null&&V.isFavorite?"favorite":"favorite_border"),1),e[45]||(e[45]=n("span",{class:"button-label"},"–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ",-1))],2)]),n("div",Dn,[n("button",{class:L(["watching-btn",{active:(pe=(Q=_.movieInfo)==null?void 0:Q.lists)==null?void 0:pe.isWatching}]),onClick:e[3]||(e[3]=r=>Ie(be(Y).WATCHING))},[n("span",qn,b((P=(K=_.movieInfo)==null?void 0:K.lists)!=null&&P.isWatching?"visibility":"visibility_off"),1),e[46]||(e[46]=n("span",{class:"button-label"},"–°–º–æ—Ç—Ä—é",-1))],2)]),n("div",Hn,[n("button",{class:L(["later-btn",{active:(de=(q=_.movieInfo)==null?void 0:q.lists)==null?void 0:de.isLater}]),onClick:e[4]||(e[4]=r=>Ie(be(Y).LATER))},e[47]||(e[47]=[n("span",{class:"material-icons"},"watch_later",-1),n("span",{class:"button-label"},"–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ",-1)]),2)]),n("div",Wn,[n("button",{class:L(["completed-btn",{active:(te=(we=_.movieInfo)==null?void 0:we.lists)==null?void 0:te.isCompleted}]),onClick:e[5]||(e[5]=r=>Ie(be(Y).COMPLETED))},[n("span",zn,b((ce=(G=_.movieInfo)==null?void 0:G.lists)!=null&&ce.isCompleted?"check_circle":"check_circle_outline"),1),e[48]||(e[48]=n("span",{class:"button-label"},"–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ",-1))],2)]),n("div",Vn,[n("button",{class:L(["abandoned-btn",{active:(Be=(ke=_.movieInfo)==null?void 0:ke.lists)==null?void 0:Be.isAbandoned}]),onClick:e[6]||(e[6]=r=>Ie(be(Y).ABANDONED))},[n("span",Un,b(((Ue=(Fe=_.movieInfo)==null?void 0:Fe.lists)!=null&&Ue.isAbandoned,"not_interested")),1),e[49]||(e[49]=n("span",{class:"button-label"},"–ë—Ä–æ—à–µ–Ω–æ",-1))],2)]),n("div",{class:"tooltip-hint"},[e[51]||(e[51]=n("span",{class:"material-icons"},"settings",-1)),n("span",null,[e[50]||(e[50]=Ke("–°—Ç–∏–ª—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ ")),n("a",{class:"settings-link",onClick:Ho},"–Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö")])])],544),[[se,A.value==="favorite"&&Bt.value]])],512)):ie("",!0),pt.value?ie("",!0):(w(),S(De,{key:1},[n("div",Kn,[n("button",{class:L(["dimming-btn",{active:bt.value}]),onMouseenter:e[7]||(e[7]=r=>re("dimming")),onMouseleave:e[8]||(e[8]=r=>A.value=null),onClick:$o},[n("span",Gn,b(bt.value?"light_mode":"dark_mode"),1)],34),ne(n("div",{class:"custom-tooltip","data-tooltip":"dimming"},b(bt.value?"–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ":"–í–∫–ª—é—á–∏—Ç—å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ"),513),[[se,A.value==="dimming"]])]),n("div",Yn,[n("button",{class:L(["blur-btn",{"electron-only":!x.value}]),onMouseenter:e[9]||(e[9]=r=>re("blur")),onMouseleave:e[10]||(e[10]=r=>A.value=null),onClick:Ao},e[52]||(e[52]=[n("span",{class:"material-icons"},"blur_on",-1)]),34),ne(n("div",{class:"custom-tooltip","data-tooltip":"blur"},b(x.value?"–ë–ª—é—Ä":"–ë–ª—é—Ä, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[se,A.value==="blur"]])]),n("div",jn,[n("button",{class:L(["material-symbols-outlined",{active:Ve.value,"electron-only":!x.value}]),onMouseenter:e[11]||(e[11]=r=>re("compressor")),onMouseleave:e[12]||(e[12]=r=>A.value=null),onClick:Yt},e[53]||(e[53]=[n("span",{class:"material-icons"},"graphic_eq",-1)]),34),ne(n("div",{class:"custom-tooltip","data-tooltip":"compressor"},b(x.value?"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä":"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[se,A.value==="compressor"]])]),n("div",Xn,[n("button",{class:L(["mirror-btn",{active:Je.value,"electron-only":!x.value}]),onMouseenter:e[13]||(e[13]=r=>re("mirror")),onMouseleave:e[14]||(e[14]=r=>A.value=null),onClick:jt},e[54]||(e[54]=[n("span",{class:"material-icons"},"flip",-1)]),34),ne(n("div",{class:"custom-tooltip","data-tooltip":"mirror"},b(x.value?"–ó–µ—Ä–∫–∞–ª–æ":"–ó–µ—Ä–∫–∞–ª–æ, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[se,A.value==="mirror"]])]),n("div",Jn,[n("button",{class:"theater-mode-btn",onMouseenter:e[15]||(e[15]=r=>re("theater")),onMouseleave:e[16]||(e[16]=r=>A.value=null),onClick:ht},[n("span",Zn,b(W.value?"fullscreen_exit":"aspect_ratio"),1)],32),ne(n("div",Qn,[Ke(b(W.value?"–í—ã–π—Ç–∏ –∏–∑ —Ç–µ–∞—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞":"–¢–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º")+" ",1),e[55]||(e[55]=n("span",{class:"shortcut-hint"},"Alt+T",-1))],512),[[se,A.value==="theater"]])]),n("div",es,[n("button",{class:L(["pip-btn",{"electron-only":!x.value}]),onMouseenter:e[17]||(e[17]=r=>re("pip")),onMouseleave:e[18]||(e[18]=r=>A.value=null),onClick:Wo},e[56]||(e[56]=[n("span",{class:"material-icons"},"picture_in_picture_alt",-1)]),34),ne(n("div",{class:"custom-tooltip","data-tooltip":"pip"},b(x.value?"–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ":"–ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –∫–∞—Ä—Ç–∏–Ω–∫–µ, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"),513),[[se,A.value==="pip"]])]),n("div",ts,[n("button",{class:"aspect-ratio-dropdown-btn",onMouseenter:e[19]||(e[19]=r=>re("aspect_ratio")),onMouseleave:Ct,onClick:_o},[n("span",os,b(Oe.value),1)],32),ne(n("div",{class:"custom-tooltip advanced-tooltip aspect-ratio-dropdown","data-tooltip":"aspect_ratio",onMouseenter:It,onMouseleave:gt},[(w(),S(De,null,ot(wt,r=>n("div",{key:r,class:L(["aspect-ratio-option",{active:Oe.value===r}]),onClick:Nt=>Jt(r)},b(r),11,ns)),64))],544),[[se,A.value==="aspect_ratio"]])]),n("div",{class:"tooltip-container","data-tooltip-container":"centering",onMouseenter:e[21]||(e[21]=r=>re("centering")),onMouseleave:Ct},[n("button",{class:"center-btn",onClick:it},e[57]||(e[57]=[n("span",{class:"material-icons"},"center_focus_strong",-1)])),ne(n("div",{class:"custom-tooltip advanced-tooltip","data-tooltip":"centering",onMouseenter:It,onMouseleave:gt},[e[58]||(e[58]=Ke(" –û—Ç—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–ª–µ–µ—Ä ")),Dt(un,{modelValue:st.value,"onUpdate:modelValue":e[20]||(e[20]=r=>st.value=r),title:"–ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞"},null,8,["modelValue"]),e[59]||(e[59]=n("span",{class:"tooltip-title"},"–ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞",-1))],544),[[se,A.value==="centering"]])],32),!x.value&&E.value?(w(),S("div",ss,[n("button",{class:"app-link-btn",onMouseenter:e[22]||(e[22]=r=>re("app_link")),onMouseleave:e[23]||(e[23]=r=>A.value=null),onClick:Oo},e[60]||(e[60]=[n("span",{class:"material-icons"},"open_in_new",-1)]),32),ne(n("div",is," –û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ",512),[[se,A.value==="app_link"]])])):ie("",!0),x.value?(w(),S("div",ls,[n("button",{class:"copy-link-btn",onMouseenter:e[24]||(e[24]=r=>re("copy_link")),onMouseleave:e[25]||(e[25]=r=>A.value=null),onClick:No},e[61]||(e[61]=[n("span",{class:"material-icons"},"content_copy",-1)]),32),ne(n("div",as," –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É ",512),[[se,A.value==="copy_link"]])])):ie("",!0),x.value?(w(),S("div",rs,[n("button",{class:L(["overlay-btn",{active:D.value}]),onMouseenter:e[26]||(e[26]=r=>re("overlay")),onMouseleave:e[27]||(e[27]=r=>A.value=null),onClick:zo},[n("span",cs,b(D.value?"layers":"layers_clear"),1)],34),ne(n("div",{class:"custom-tooltip","data-tooltip":"overlay"},b(D.value?"–°–∫—Ä—ã—Ç—å –æ–≤–µ—Ä–ª–µ–π –≤–∏–¥–µ–æ":"–ü–æ–∫–∞–∑–∞—Ç—å –æ–≤–µ—Ä–ª–µ–π –≤–∏–¥–µ–æ"),513),[[se,A.value==="overlay"]])])):ie("",!0)],64))]),!pt.value&&!Bt.value&&E.value?(w(),S("div",us,[n("div",ds,[n("button",{class:L(["favorite-btn",{active:(Pt=(lt=_.movieInfo)==null?void 0:lt.lists)==null?void 0:Pt.isFavorite}]),onMouseenter:e[28]||(e[28]=r=>re("favorite")),onMouseleave:e[29]||(e[29]=r=>A.value=null),onClick:e[30]||(e[30]=r=>Ie(be(Y).FAVORITE))},[n("span",vs,b((Ot=(Re=_.movieInfo)==null?void 0:Re.lists)!=null&&Ot.isFavorite?"favorite":"favorite_border"),1)],34),ne(n("div",ps,b("–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"),512),[[se,A.value==="favorite"]])]),n("div",ms,[n("button",{class:L(["watching-btn",{active:(rt=(at=_.movieInfo)==null?void 0:at.lists)==null?void 0:rt.isWatching}]),onMouseenter:e[31]||(e[31]=r=>re("watching")),onMouseleave:e[32]||(e[32]=r=>A.value=null),onClick:e[33]||(e[33]=r=>Ie(be(Y).WATCHING))},[n("span",fs,b((Le=(ct=_.movieInfo)==null?void 0:ct.lists)!=null&&Le.isWatching?"visibility":"visibility_off"),1)],34),ne(n("div",gs,b("–°–º–æ—Ç—Ä—é"),512),[[se,A.value==="watching"]])]),n("div",ys,[n("button",{class:L(["later-btn",{active:(u=(ut=_.movieInfo)==null?void 0:ut.lists)==null?void 0:u.isLater}]),onMouseenter:e[34]||(e[34]=r=>re("later")),onMouseleave:e[35]||(e[35]=r=>A.value=null),onClick:e[36]||(e[36]=r=>Ie(be(Y).LATER))},e[62]||(e[62]=[n("span",{class:"material-icons"},"watch_later",-1)]),34),ne(n("div",hs,b("–°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∑–∂–µ"),512),[[se,A.value==="later"]])]),n("div",bs,[n("button",{class:L(["completed-btn",{active:(O=(B=_.movieInfo)==null?void 0:B.lists)==null?void 0:O.isCompleted}]),onMouseenter:e[37]||(e[37]=r=>re("completed")),onMouseleave:e[38]||(e[38]=r=>A.value=null),onClick:e[39]||(e[39]=r=>Ie(be(Y).COMPLETED))},[n("span",ws,b((Me=(ye=_.movieInfo)==null?void 0:ye.lists)!=null&&Me.isCompleted?"check_circle":"check_circle_outline"),1)],34),ne(n("div",ks,b("–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"),512),[[se,A.value==="completed"]])]),n("div",xs,[n("button",{class:L(["abandoned-btn",{active:(oe=(me=_.movieInfo)==null?void 0:me.lists)==null?void 0:oe.isAbandoned}]),onMouseenter:e[40]||(e[40]=r=>re("abandoned")),onMouseleave:e[41]||(e[41]=r=>A.value=null),onClick:e[42]||(e[42]=r=>Ie(be(Y).ABANDONED))},[n("span",Ss,b(((he=(_e=_.movieInfo)==null?void 0:_e.lists)!=null&&he.isAbandoned,"not_interested")),1)],34),ne(n("div",Cs,b("–ë—Ä–æ—à–µ–Ω–æ"),512),[[se,A.value==="abandoned"]])])])):ie("",!0)])),Dt(vo,{ref_key:"notificationRef",ref:Ge},null,512)],64))}}},Ws=qt(Is,[["__scopeId","data-v-b162377e"]]),Es={class:"rating-container"},Ts={class:"rating-display"},As={class:"rating-numbers"},$s=["onClick","onMouseenter"],Ms={key:0,class:"tooltip-footer"},Bs={class:"rating-numbers mobile-rating-numbers"},Fs=["onClick"],Ps={key:0,class:"mobile-modal-footer"},Os={__name:"MovieRating",props:{kpId:{type:String,required:!0},showDash:{type:Boolean,default:!1}},setup(_){const l=ro(),v=co(),c=_,f=p(null),k=p(null),R=p(null),E=p(null),d=p(0),H=p(!1),X=p(!1);let F=null;const ae=ee=>ee?ee.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "):"0",W=()=>{F=setTimeout(()=>{H.value=!1,l.isMobile||(X.value=!1)},100)},$=()=>{F&&(clearTimeout(F),F=null),H.value=!0},y=()=>{l.isMobile&&(X.value=!X.value)},C=()=>{v.push("/login")},z=async()=>{try{const ee=await an(c.kpId);k.value=ee.user_rating,R.value=ee.average_rating,E.value=ae(ee.vote_count)}catch(ee){console.error("Error loading rating:",ee)}},I=async ee=>{var Z;try{ee===k.value?(await ao(c.kpId,null),k.value=null,f.value.showNotification("–û—Ü–µ–Ω–∫–∞ —É–¥–∞–ª–µ–Ω–∞")):(await ao(c.kpId,ee),k.value=ee,f.value.showNotification("–û—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞")),l.isMobile&&(X.value=!1),z()}catch(j){console.error("Error setting rating:",j),((Z=j.response)==null?void 0:Z.status)===401?f.value.showNotification('–î–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a class="auth-link">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>',5e3,{onClick:C}):f.value.showNotification("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ—Ü–µ–Ω–∫–∏"),l.isMobile&&(X.value=!1)}},Ce=()=>{X.value=!1};return uo(()=>{z()}),(ee,Z)=>(w(),S("div",Es,[n("div",Ts,[n("a",{href:"#",class:L(["rating-link",{"has-rating":k.value}]),onMouseenter:Z[0]||(Z[0]=j=>H.value=!0),onMouseleave:W,onClick:dt(y,["prevent"])},[Z[3]||(Z[3]=n("img",{src:dn,alt:"ReYohoho",class:"rating-logo"},null,-1)),n("span",{class:L(["average-rating",be(ln)(R.value)])},b(R.value?R.value.toFixed(1).replace(/\.0$/,""):"‚Äî"),3)],34),ne(n("div",{class:"rating-tooltip",onMouseenter:$,onMouseleave:W},[n("div",As,[(w(),S(De,null,ot(10,j=>n("button",{key:j,class:L(["number-btn",{active:j===k.value,hover:j===d.value,"average-highlight":R.value&&j<=Math.round(R.value)}]),onClick:qe=>I(j),onMouseenter:qe=>d.value=j,onMouseleave:Z[1]||(Z[1]=qe=>d.value=0)},b(j),43,$s)),64))]),E.value?(w(),S("div",Ms,"–û—Ü–µ–Ω–æ–∫: "+b(E.value),1)):ie("",!0)],544),[[se,(H.value||X.value)&&!be(l).isMobile]])]),Dt(vo,{ref_key:"notificationRef",ref:f},null,512),be(l).isMobile&&X.value?(w(),S("div",{key:0,class:"mobile-modal-overlay",onClick:Ce},[n("div",{class:"mobile-modal",onClick:Z[2]||(Z[2]=dt(()=>{},["stop"]))},[n("div",{class:"mobile-modal-header"},[Z[4]||(Z[4]=n("h3",null,"–û—Ü–µ–Ω–∏—Ç—å —Ñ–∏–ª—å–º",-1)),n("button",{class:"close-button",onClick:Ce},"√ó")]),n("div",Bs,[(w(),S(De,null,ot(10,j=>n("button",{key:j,class:L(["number-btn",{active:j===k.value,"average-highlight":R.value&&j<=Math.round(R.value)}]),onClick:qe=>I(j)},b(j),11,Fs)),64))]),E.value?(w(),S("div",Ps,"–û—Ü–µ–Ω–æ–∫: "+b(E.value),1)):ie("",!0)])])):ie("",!0)]))}},zs=qt(Os,[["__scopeId","data-v-2df64bd5"]]);export{zs as M,Ws as P,qs as _,Hs as a};
